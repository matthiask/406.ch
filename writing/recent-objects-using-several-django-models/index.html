<!doctypehtml><html lang=en><meta charset=utf-8><meta content=width=device-width,initial-scale=1.0 name=viewport><title>Recent objects using several Django models - Matthias Kestenholz</title><link href=/styles.85553ee449ca.css rel=stylesheet><link title="Blog feed"href=/writing/atom.xml rel=alternate type=application/atom+xml><body><header><div class=wrappy><a class=title href=/>Hi, I'm Matthias</a><p class=subtitle>I am a founding partner of <a href=https://feinheit.ch>Feinheit AG</a> and <a href=https://diebruchpiloten.com>Die Bruchpiloten AG</a>. Find me on <a href=https://github.com/matthiask/>GitHub</a>, <a href=https://hachyderm.io/@matthiask rel=me>Mastodon</a>, <a href=https://bsky.app/profile/matthiask.406.ch rel=me>Bluesky</a>, <a rel="noopener noreferrer"title="if you must"href=https://www.linkedin.com/in/matthiaskestenholz target=_blank>LinkedIn</a> or by <a href=mailto:mk@406.ch>email</a>.<nav><a href=/writing/category-climate/>Climate</a><a href=/writing/category-django/>Django</a><a href=/writing/category-feincms/>feincms</a><a href=/writing/category-feincms3/>feincms3</a><a href=/writing/category-politik/>Politik</a><a href=/writing/category-programming/>Programming</a><a href=/writing/category-python/>Python</a><a href=/writing/category-weeknotes/>Weeknotes</a></nav></div></header><main><div class=wrappy><div class=text><small>2022-05-11 </small><h1 id=recent-objects-using-several-django-models><a class=toclink href=#recent-objects-using-several-django-models>Recent objects using several Django models</a></h1><p>I released a new Python package which builds on the excellent code published by Simon Willison in the blog post <a href=https://simonwillison.net/2018/Mar/25/combined-recent-additions/>Building a combined stream of recent additions using the Django ORM</a>. The rationale etc. for why this is useful is described much better by him and I’ll save everyone’s time by not repeating it in a worse way.<p>The new package is <a href=https://github.com/matthiask/django-recent-objects/>django-recent-objects</a>, developed on GitHub and available from PyPI.<p>The package supports e.g. combining recent articles and comments in a single activity stream:<div class=chl><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>testapp.models</span><span class=w> </span><span class=kn>import</span><span class=w> </span><span class=n>Article</span><span class=p>,</span><span class=w> </span><span class=n>Comment</span>
<span class=kn>from</span><span class=w> </span><span class=nn>recent_objects.recent_objects</span><span class=w> </span><span class=kn>import</span><span class=w> </span><span class=n>RecentObjects</span>

<span class=n>ro</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>RecentObjects</span><span class=p>(</span>
<span class=w>    </span><span class=p>[</span>
<span class=w>        </span><span class=p>{</span>
<span class=w>            </span><span class=s2>"queryset"</span><span class=p>:</span><span class=w> </span><span class=n>Article</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>all</span><span class=p>(),</span>
<span class=w>            </span><span class=s2>"date_field"</span><span class=p>:</span><span class=w> </span><span class=s2>"created_at"</span><span class=p>,</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=p>{</span>
<span class=w>            </span><span class=s2>"queryset"</span><span class=p>:</span><span class=w> </span><span class=n>Comment</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>all</span><span class=p>(),</span>
<span class=w>            </span><span class=s2>"date_field"</span><span class=p>:</span><span class=w> </span><span class=s2>"created_at"</span><span class=p>,</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>    </span><span class=p>]</span>
<span class=p>)</span>

<span class=n>additions</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ro</span><span class=o>.</span><span class=n>page</span><span class=p>(</span><span class=n>paginate_by</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=n>page</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</code></pre></div><p><a href=https://github.com/matthiask/django-recent-objects/>django-recent-objects</a> adds the following features which aren’t available in the blogpost linked above:<ul><li>The name of the <code>date_field</code> doesn’t have to be the same for all objects<li>Primary keys of different types are<sup id=fnref:1><a class=footnote-ref href=#fn:1>1</a></sup> supported<li>The code uses a real paginator and doesn’t only support fetching the first few objects</ul><div class=footnote><hr><ol><li id=fn:1><p>Hopefully! <a title="Jump back to footnote 1 in the text"class=footnote-backref href=#fnref:1>↩</a></p></ol></div></div><div class="text prevnext"><a href=/writing/generating-xlsx-or-csv-from-the-django-admin-or-elsewhere/>Previous post</a><a href=/writing/weeknotes-2021-week-13-and-14/>Next post</a></div></div></main><footer><div class=wrappy><p><small> I like feedback! <a href="mailto:mk@406.ch?subject=Recent objects using several Django models">Send me an email.</a> <br> <a rel="noopener noreferrer"href=https://ko-fi.com/matthiask target=_blank>☕ Buy me a coffee?</a> <br> Published on 2022-05-11 in <a href=/writing/category-django/>Django</a>, <a href=/writing/category-programming/>Programming</a> </small></p><script async crossorigin issue-term=pathname repo=matthiask/406-comments src=https://utteranc.es/client.js theme=github-light></script></div></footer>