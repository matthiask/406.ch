<!doctype html><html lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1.0" name=viewport><title>Weeknotes (2023 week 48) - Matthias Kestenholz</title><link href=/styles.6cf33c7d4923.css rel=stylesheet><link title="Blog feed" href=/writing/atom.xml rel=alternate type=application/atom+xml><body><header><div class=wrappy><a class=title href=/>Hi, I'm Matthias</a><p class=subtitle>I am a founding partner of <a href=https://feinheit.ch>Feinheit AG</a> and <a href=https://diebruchpiloten.com>Die Bruchpiloten AG</a>. Find me on <a href=https://github.com/matthiask/>GitHub</a>, <a href=https://hachyderm.io/@matthiask rel=me>Mastodon</a>, <a href=https://bsky.app/profile/matthiask.406.ch rel=me>Bluesky</a>, <a rel="noopener noreferrer" title="if you must" href=https://www.linkedin.com/in/matthiaskestenholz target=_blank>LinkedIn</a> or by <a href=mailto:mk@406.ch>email</a>.<nav><a href=/writing/category-climate/>Climate</a><a href=/writing/category-django/>Django</a><a href=/writing/category-feincms/>feincms</a><a href=/writing/category-politik/>Politik</a><a href=/writing/category-programming/>Programming</a><a href=/writing/category-python/>Python</a><a href=/writing/category-til/>TIL</a><a href=/writing/category-weeknotes/>Weeknotes</a></nav></div></header><main><div class=wrappy><div class=text><small>2023-11-30 </small><h1 id=weeknotes-2023-week-48><a class=toclink href=#weeknotes-2023-week-48>Weeknotes (2023 week 48)</a></h1><p>A few weeks have passed since the last update. The whole family was repeatedly sick with different viruses etc… I hope that the worst is over now. Who knows.<h2 id=12-factor-django-storage-configuration><a class=toclink href=#12-factor-django-storage-configuration>12-factor Django storage configuration</a></h2><p>I should maybe write a longer and separate post about this, but <a href=https://pypi.org/project/speckenv/>speckenv</a> has gained support for the Django <code>STORAGES</code> setting. No documentation yet, but it supports two storage backends for now, the file system storage and <a href=https://github.com/etianen/django-s3-storage/>django-s3-storage</a>, my go-to library for S3-compatible services.<p>Using it looks something like this:<div class=chl><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>speckenv</span><span class=w> </span><span class=kn>import</span> <span class=n>env</span>
<span class=kn>from</span><span class=w> </span><span class=nn>speckenv_django</span><span class=w> </span><span class=kn>import</span> <span class=n>django_storage_url</span>

<span class=n>STORAGES</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s2>"default"</span><span class=p>:</span> <span class=n>django_storage_url</span><span class=p>(</span>
        <span class=n>env</span><span class=p>(</span>
            <span class=s2>"STORAGE_URL"</span><span class=p>,</span>
            <span class=n>default</span><span class=o>=</span><span class=s2>"file:./media/?base_url=/media/"</span><span class=p>,</span>
            <span class=n>warn</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
        <span class=p>),</span>
        <span class=n>base_dir</span><span class=o>=</span><span class=n>BASE_DIR</span><span class=p>,</span>
    <span class=p>),</span>
    <span class=s2>"staticfiles"</span><span class=p>:</span> <span class=p>{</span>
        <span class=s2>"BACKEND"</span><span class=p>:</span> <span class=s2>"django.contrib.staticfiles.storage.ManifestStaticFilesStorage"</span><span class=p>,</span>
    <span class=p>},</span>
<span class=p>}</span>
</code></pre></div><p>Then, if you want to use S3 you can put something like this in your <code>.env</code> file:<div class=chl><pre><span></span><code><span class=n>STORAGE_URL</span><span class=o>=</span><span class=nl>s3</span><span class=p>:</span><span class=o>//</span><span class=n>access</span><span class=o>-</span><span class=k>key</span><span class=err>:</span><span class=n>secret</span><span class=nv>@bucket</span><span class=p>.</span><span class=n>name</span><span class=p>.</span><span class=n>s3</span><span class=p>.</span><span class=n>eu</span><span class=o>-</span><span class=n>central</span><span class=o>-</span><span class=mf>1.</span><span class=n>amazonaws</span><span class=p>.</span><span class=n>com</span><span class=o>/</span><span class=n>media</span><span class=o>/</span>
</code></pre></div><p>Or maybe something like this, if you want to serve media files without authentication:<div class=chl><pre><span></span><code><span class=n>STORAGE_URL</span><span class=o>=</span><span class=nl>s3</span><span class=p>:</span><span class=o>//</span><span class=n>access</span><span class=o>-</span><span class=k>key</span><span class=err>:</span><span class=n>secret</span><span class=nv>@bucket</span><span class=p>.</span><span class=n>name</span><span class=p>.</span><span class=n>s3</span><span class=p>.</span><span class=n>eu</span><span class=o>-</span><span class=n>central</span><span class=o>-</span><span class=mf>1.</span><span class=n>amazonaws</span><span class=p>.</span><span class=n>com</span><span class=o>/</span><span class=n>media</span><span class=o>/</span><span class=vm>?</span><span class=n>aws_s3_public_auth</span><span class=o>=</span><span class=k>False</span><span class=o>&</span><span class=n>aws_s3_max_age_seconds</span><span class=o>=</span><span class=mi>31536000</span>
</code></pre></div><h2 id=releases><a class=toclink href=#releases>Releases</a></h2><ul><li><a href=https://pypi.org/project/speckenv/>speckenv 6.1.1</a>: See above.<li><a href=https://pypi.org/project/feincms3-meta/>feincms3-meta 4.6</a>: York has contributed support for emitting structured data records. Looks nice. No documentation yet.<li><a href=https://pypi.org/project/django-tree-queries/>django-tree-queries 0.16.1</a>: <code>.values()</code> and <code>.values_list()</code> queries are now handled better and more consistently than before.</ul></div><div class="text prevnext"><a href=/writing/django-json-schema-editor/>Previous post</a><a href=/writing/weeknotes-2023-week-44/>Next post</a></div></div></main><footer><div class=wrappy><p><small> I like feedback! <a href="mailto:mk@406.ch?subject=Weeknotes (2023 week 48)">Send me an email.</a> <br> <a rel="noopener noreferrer" href=https://ko-fi.com/matthiask target=_blank>☕ Buy me a coffee?</a> <br> Published on 2023-11-30 in <a href=/writing/category-django/>Django</a>, <a href=/writing/category-programming/>Programming</a>, <a href=/writing/category-weeknotes/>Weeknotes</a> </small></p><script async crossorigin issue-term=pathname repo=matthiask/406-comments src=https://utteranc.es/client.js theme=github-dark></script></div></footer>