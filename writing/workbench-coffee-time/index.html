<!doctypehtml><html lang=en><meta charset=utf-8><meta content=width=device-width,initial-scale=1.0 name=viewport><title>Workbench: Coffee time! - Matthias Kestenholz</title><link href=/styles.e734bff1fc91.css rel=stylesheet><link title="Blog feed"href=/writing/atom.xml rel=alternate type=application/atom+xml><body><header><div class=wrappy><a class=title href=/>Hi, I'm Matthias</a><p class=subtitle>I am a founding partner of <a href=https://feinheit.ch>Feinheit AG</a> and <a href=https://diebruchpiloten.com>Die Bruchpiloten AG</a>. Find me on <a href=https://github.com/matthiask/>GitHub</a>, <a href=https://hachyderm.io/@matthiask rel=me>Mastodon</a>, <a href=https://bsky.app/profile/matthiask.406.ch rel=me>Bluesky</a>, <a rel="noopener noreferrer"title="if you must"href=https://www.linkedin.com/in/matthiaskestenholz target=_blank>LinkedIn</a> or by <a href=mailto:mk@406.ch>email</a>.<nav><a href=/writing/category-climate/>Climate</a><a href=/writing/category-django/>Django</a><a href=/writing/category-feincms/>feincms</a><a href=/writing/category-feincms3/>feincms3</a><a href=/writing/category-politik/>Politik</a><a href=/writing/category-programming/>Programming</a><a href=/writing/category-python/>Python</a><a href=/writing/category-til/>TIL</a><a href=/writing/category-weeknotes/>Weeknotes</a></nav></div></header><main><div class=wrappy><div class=text><small>2024-05-24 </small><h1 id=workbench-coffee-time><a class=toclink href=#workbench-coffee-time>Workbench: Coffee time!</a></h1><p>I have written about <a href=https://406.ch/writing/workbench-the-django-based-agency-software/>the Workbench agency software</a> a few weeks back.<p>Back when we were using Slack at <a href=https://feinheit.ch/>Feinheit</a> we used a Donut bot to generate randomized invites for a coffee break. <a href=https://406.ch/writing/why-we-switched-from-slack-to-discord-at-work/>We lost that bot when we switched to Discord</a>. I searched some time for an equivalent bot for Discord but couldn’t find any, so like any self-respecting nerd, break lover and NIH-sufferer I reimplemented the functionality as a part of our agency software.<p>The first version generated totally random pairings without any history; I thought that maybe this would be good enough, but of course I received an invite for a coffee with the exact same person in the first two invitations. Even though I did enjoy the break both times this motivated me to put some effort into a better solution :-)<p>The result of this work is the <a href=https://github.com/matthiask/workbench/blob/a14d8b9560def7a4e2bbf7531eb6108f734568db/workbench/accounts/tasks.py#L57><code>coffee_invites()</code> function</a><p>There are two main parts to the generator:<ul><li>It randomly generates twenty pairings from all participants; it prefers groups of two except for the last group which may contain three people.<li>It loads old pairings from the database and gives higher penalties to equal pairings depending on the time which has passed since the last time.</ul><p>So, it’s not mathematically perfect, but all imbalances will cancel out over a long time. I experimented with the discounting factor and the number of random pairings it generates upfront. The values in the code seem to work fine.<p>Sometimes it’s simple stuff like this which gets me going and reignites the love for programming. Like a small puzzle.</div><div class="text prevnext"><a href=/writing/weeknotes-2024-week-23/>Previous post</a><a href=/writing/weeknotes-2024-week-21/>Next post</a></div></div></main><footer><div class=wrappy><p><small> I like feedback! <a href="mailto:mk@406.ch?subject=Workbench: Coffee time!">Send me an email.</a> <br> <a rel="noopener noreferrer"href=https://ko-fi.com/matthiask target=_blank>☕ Buy me a coffee?</a> <br> Published on 2024-05-24 in <a href=/writing/category-django/>Django</a>, <a href=/writing/category-programming/>Programming</a> </small></p><script async crossorigin issue-term=pathname repo=matthiask/406-comments src=https://utteranc.es/client.js theme=github-dark></script></div></footer>