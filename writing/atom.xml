<?xml version='1.0' encoding='utf-8'?>
<feed xml:lang="en" xmlns="http://www.w3.org/2005/Atom"><title>Matthias Kestenholz</title><link href="https://406.ch/writing/atom.xml" rel="self" /><link href="https://406.ch/" rel="alternate" /><id>https://406.ch/</id><updated>2024-12-18T12:00:00Z</updated><author><name>Matthias Kestenholz</name></author><entry><title>Object-based assets for Django's forms.Media</title><link href="https://406.ch/writing/object-based-assets-for-django-s-forms-media/" rel="alternate" /><id>https://406.ch/writing/object-based-assets-for-django-s-forms-media/</id><published>2024-12-18T12:00:00Z</published><updated>2024-12-18T12:00:00Z</updated><summary type="html">&lt;h1 id="object-based-assets-for-djangos-formsmedia"&gt;&lt;a class="toclink" href="#object-based-assets-for-djangos-formsmedia"&gt;Object-based assets for Django&amp;rsquo;s forms.Media&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;The pull request for adding &lt;a href="https://github.com/django/django/pull/18782"&gt;object-based script media assets into
Django&lt;/a&gt; is in a good state and I
hope it will be merged soon. I have been using object-based assets long before
&lt;a href="https://github.com/django/django/commit/4c76ffc2d6c77"&gt;Django actually added support for them in
4.1&lt;/a&gt; (&lt;a href="https://github.com/feincms/django-content-editor/commit/82ac91ea7af2409bb3672e11c18871002ddc9753"&gt;since
2016&lt;/a&gt;,
that&amp;rsquo;s before Django 1.10!) by using a gross hack. Luckily I have been able to
clean up the code when Django 4.1 landed.&lt;/p&gt;
&lt;p&gt;I have been asking myself at times why I haven&amp;rsquo;t proposed the change to Django
myself despite having been a user of something like this for such a long time.
After all, I have been happily contributing issue reports, bug fixes and tests
to Django. The process of adding new features sometimes is terribly frustrating
even when looking (and cheering) from the sidelines, it takes so much time and
energy. It feels bad that adding another package to the &lt;a href="https://pypi.org/user/matthiask/"&gt;list of packages I
maintain&lt;/a&gt; so clearly seems to be the better
way to &lt;strong&gt;get things done&lt;/strong&gt; compared to proposing a new feature for Django
itself. I hope &lt;a href="https://406.ch/writing/weeknotes-2024-week-49/"&gt;processes change
somewhat&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;But I digress.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;ProseEditorWidget&lt;/code&gt; in
&lt;a href="https://github.com/matthiask/django-prose-editor/"&gt;django-prose-editor&lt;/a&gt; wants
to ship CSS, JavaScript and some JSON to the browser for the widget. So, of
course I used object-based media assets for this instead of widget HTML
templates. Media assets are deduplicated and sorted by Django. If different
editor presets use differing lists of assets they are smartly merged by
&lt;code&gt;forms.Media&lt;/code&gt; using a topological sort. You get those niceties for free when
using &lt;code&gt;forms.Media&lt;/code&gt; and everything just works, so what&amp;rsquo;s not to like?&lt;/p&gt;
&lt;p&gt;The only thing which isn&amp;rsquo;t to like is that Django, at the time of writing,
doesn&amp;rsquo;t provide any classes helping with this. You can put strings into
&lt;code&gt;forms.Media&lt;/code&gt; or you can put objects with a &lt;code&gt;__html__()&lt;/code&gt; method in there. The
latter of course is all that&amp;rsquo;s needed to support more advanced use cases &amp;ndash; and
that&amp;rsquo;s exactly what
&lt;a href="https://pypi.org/project/django-js-asset/"&gt;django-js-asset&lt;/a&gt; now provides, and
what django-prose-editor uses.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://pypi.org/project/django-js-asset/"&gt;django-js-asset&lt;/a&gt; has long supported
a &lt;code&gt;JS&lt;/code&gt; class with support for additional
attributes, for example:&lt;/p&gt;
&lt;div class="chl"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;js_asset&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;JS&lt;/span&gt;

&lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Media&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;js&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="n"&gt;JS&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;asset.js&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;asset-script&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;data-answer&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;42&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;}),&lt;/span&gt;
&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Since 3.0 the package also comes with a &lt;code&gt;CSS&lt;/code&gt; and &lt;code&gt;JSON&lt;/code&gt; class:&lt;/p&gt;
&lt;div class="chl"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;js_asset&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;CSS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;JS&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;JSON&lt;/span&gt;

&lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Media&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;js&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="n"&gt;JSON&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;cfg&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;42&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="nb"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;widget-cfg&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;CSS&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;widget/style.css&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;CSS&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;p{color:red;}&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;inline&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;JS&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;widget/script.js&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;type&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;module&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;}),&lt;/span&gt;
&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This produces the following HTML:&lt;/p&gt;
&lt;div class="chl"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;widget-cfg&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;application/json&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;cfg&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;42&lt;/span&gt;&lt;span class="p"&gt;}&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;link&lt;/span&gt; &lt;span class="na"&gt;rel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;stylesheet&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/static/widget/style.css&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;style&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="k"&gt;color&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="kc"&gt;red&lt;/span&gt;&lt;span class="p"&gt;;}&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;style&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt; &lt;span class="na"&gt;src&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/static/widget/script.js&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;module&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The code which is proposed for Django supports the JavaScript use case but with
a slightly different API:&lt;/p&gt;
&lt;div class="chl"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Media&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;js&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="n"&gt;Script&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;widget/script.js&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;module&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This looks slightly nicer as long as you don&amp;rsquo;t use e.g. data attributes,
because then you have to do:&lt;/p&gt;
&lt;div class="chl"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Media&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;js&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="n"&gt;Script&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;widget/script.js&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;data-cfg&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;}),&lt;/span&gt;
&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;I always forget that Python supports passing keyword arguments names which
aren&amp;rsquo;t valid Python identifiers (but only when using &lt;code&gt;**kwargs&lt;/code&gt;). I personally
don&amp;rsquo;t care much either way, and when my packages can finally drop compatibility
with Django versions which do not support all these functionalities yet I&amp;rsquo;ll
finally be able to retire
&lt;a href="https://pypi.org/project/django-js-asset/"&gt;django-js-asset&lt;/a&gt;. That won&amp;rsquo;t happen
any time soon though, if only because I like supporting old versions of Django
because I have so many Django-based websites running somewhere.&lt;/p&gt;</summary></entry><entry><title>Weeknotes (2024 week 49)</title><link href="https://406.ch/writing/weeknotes-2024-week-49/" rel="alternate" /><id>https://406.ch/writing/weeknotes-2024-week-49/</id><published>2024-12-06T12:00:00Z</published><updated>2024-12-06T12:00:00Z</updated><summary type="html">&lt;h1 id="weeknotes-2024-week-49"&gt;&lt;a class="toclink" href="#weeknotes-2024-week-49"&gt;Weeknotes (2024 week 49)&lt;/a&gt;&lt;/h1&gt;
&lt;h2 id="django-steering-council-elections"&gt;&lt;a class="toclink" href="#django-steering-council-elections"&gt;Django Steering Council elections&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I have been thinking long and hard about running for the Django Steering Council. I think there are a few things I could contribute since I&amp;rsquo;ve been using Django for 16 or more years, and have been working on, maintaining and publishing third-party apps almost all this time. I have also contributed a few small features to Django core itself, and contributed my fair share of tests and bugfixes. The reason why I haven&amp;rsquo;t been more involved was always that I feared the review process with what I perceive to be a too unrestrained perfectionism. Teaching people is good, but I fear that those who teach are self-selected survivors of the process, which come to appreciate the perfectionism a bit too much. It&amp;rsquo;s somewhat the same as with the Swiss naturalization process &amp;ndash; the hurdles are very high, and some of those who weather the process maybe are or grow to be too fond of it.&lt;/p&gt;
&lt;p&gt;An important point is that this has nothing to do with being nice (or not). Everybody has always been great, maybe with the exception of myself back when I didn&amp;rsquo;t understand that the problem wasn&amp;rsquo;t the individuals but the way everyone has agreed things should be done.&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;m not the only one who thinks that we &lt;a href="https://knowyourmeme.com/memes/we-should-improve-society-somewhat"&gt;should improve the process somewhat&lt;/a&gt;. So, I&amp;rsquo;m definitely going to look out for candidates who think this is important.&lt;/p&gt;
&lt;p&gt;There are a few reasons why I&amp;rsquo;m not running myself at this time. A somewhat important reason is that my candidacy wouldn&amp;rsquo;t help diversity at all. This shouldn&amp;rsquo;t discourage anyone else with the same background from running &amp;ndash; we cannot change the world all at once. More importantly, I have more personal reasons for being hesitant to accept new commitments. That being said, I&amp;rsquo;m looking forward to be more involved in the community in other ways. And also, it&amp;rsquo;s not now or never.&lt;/p&gt;
&lt;h2 id="releases"&gt;&lt;a class="toclink" href="#releases"&gt;Releases&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/feincms3-cookiecontrol/"&gt;feincms3-cookiecontrol 1.5.4&lt;/a&gt;: No functional changes, only code golfing. It&amp;rsquo;s nice to have a working cookie banner with a solution for embedding third party content only when people consent in less than 4KiB of minified (not compressed!) JavaScript.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-admin-ordering/"&gt;django-admin-ordering 0.20&lt;/a&gt;: Objects can now be reordered using arrow buttons instead of drag drop or manually changing the ordering field&amp;rsquo;s value. This should make the package more accessible. It&amp;rsquo;s always a joy when people contribute such useful improvements.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-prose-editor/"&gt;django-prose-editor 0.10a?&lt;/a&gt;: See &lt;a href="https://406.ch/writing/rebuilding-django-prose-editor-from-the-ground-up/"&gt;the recent blog post&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;</summary></entry><entry><title>Rebuilding django-prose-editor from the ground up</title><link href="https://406.ch/writing/rebuilding-django-prose-editor-from-the-ground-up/" rel="alternate" /><id>https://406.ch/writing/rebuilding-django-prose-editor-from-the-ground-up/</id><published>2024-12-04T12:00:00Z</published><updated>2024-12-04T12:00:00Z</updated><summary type="html">&lt;h1 id="rebuilding-django-prose-editor-from-the-ground-up"&gt;&lt;a class="toclink" href="#rebuilding-django-prose-editor-from-the-ground-up"&gt;Rebuilding django-prose-editor from the ground up&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;The &lt;a href="https://pypi.org/project/django-prose-editor/"&gt;django-prose-editor&lt;/a&gt; package provides a HTML editor based upon the &lt;a href="https://prosemirror.net/"&gt;ProseMirror toolkit&lt;/a&gt; for the Django administration interface and for the frontend.&lt;/p&gt;
&lt;p&gt;The package has been extracted from a customer project and open sourced so that it could be used in other projects as well. It followed a very restricted view of how rich text editors should work, which I have initially added to the &lt;a href="https://github.com/feincms/feincms/commit/70cd7a1244438d2ba97852256f77daa2c870c345#diff-556c5559a716059d4fb714ad34de6a9845870e8d55bbd2cb9d77c732eb961388"&gt;FeinCMS repository when documenting the design decisions more than 15 years ago&lt;/a&gt; &lt;small&gt;(Note that I didn&amp;rsquo;t edit the paragraph, it&amp;rsquo;s reproduced here as it was back then, with all the errors and heedlessness.)&lt;/small&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;All of this convinced me that offering the user a rich text editor with too much capabilites is a really bad idea. The rich text editor in FeinCMS only has bold, italic, bullets, link and headlines activated (and the HTML code button, because that&amp;rsquo;s sort of inevitable &amp;ndash; sometimes the rich text editor messes up and you cannot fix it other than going directly into the HTML code. Plus, if someone really knows what he&amp;rsquo;s doing, I&amp;rsquo;d still like to give him the power to shot his own foot).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;My personal views are unchanged. I have to recognize though that forcing this idea upon everyone isn&amp;rsquo;t workable and that this would mean that I&amp;rsquo;d have to find a different editor for most projects just because people really want or need more rope. Going back to an editor which allows everything was out of the question, so I had to look around for a way to allow project-specific extensions for the editor.&lt;/p&gt;
&lt;p&gt;Of course that&amp;rsquo;s problematic, since Django packages and Python virtualenvs do not offer a good way of shipping CSS and JavaScript which should be available for a frontend bundler to process. The existing &lt;a href="https://docs.djangoproject.com/en/5.1/ref/contrib/staticfiles/"&gt;Django staticfiles app&lt;/a&gt; is great, works well, but it&amp;rsquo;s not a bundler &amp;ndash; and it shouldn&amp;rsquo;t be.&lt;/p&gt;
&lt;p&gt;So, I started shopping around for ways to make ProseMirror extensible while keeping extensions clean and well localized. Instead of inventing another plugin ecosystem I settled on &lt;a href="https://tiptap.dev/"&gt;Tiptap&lt;/a&gt; which uses ProseMirror under the hood. The abstractions are pleasantly leaky &amp;ndash; if you know how to work with ProseMirror&amp;rsquo;s API, you can use Tiptap&amp;rsquo;s API without any issues. That was important for me, since I already have a somewhat large selection of plugins which I do not want to reimplement from the ground up.&lt;/p&gt;
&lt;p&gt;I had already looked at Tiptap a few years back, but ultimately stayed with ProseMirror because I liked some behaviors better (such as not including trailing spaces in marks) and because I didn&amp;rsquo;t need the extensibility which at the time only made the resulting bundle much bigger.&lt;/p&gt;
&lt;p&gt;Now, things have improved a lot, and I&amp;rsquo;m really happy with Tiptap and the development version of django-prose-editor. &lt;a href="https://github.com/matthiask/django-prose-editor/?tab=readme-ov-file#customization"&gt;Writing an editor extension in project code is great&lt;/a&gt;, and my editor core stays nice. Also the list of readily available extensions is large, and most of the things just work.&lt;/p&gt;</summary></entry><entry><title>Weeknotes (2024 week 47)</title><link href="https://406.ch/writing/weeknotes-2024-week-47/" rel="alternate" /><id>https://406.ch/writing/weeknotes-2024-week-47/</id><published>2024-11-20T12:00:00Z</published><updated>2024-11-20T12:00:00Z</updated><summary type="html">&lt;h1 id="weeknotes-2024-week-47"&gt;&lt;a class="toclink" href="#weeknotes-2024-week-47"&gt;Weeknotes (2024 week 47)&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;I missed a single co-writing session and of course that lead to four weeks of no posts at all to the blog. Oh well.&lt;/p&gt;
&lt;h2 id="debugging"&gt;&lt;a class="toclink" href="#debugging"&gt;Debugging&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I want to share a few debugging stories from the last weeks.&lt;/p&gt;
&lt;h3 id="pillow-11-and-djangos-get_image_dimensions"&gt;&lt;a class="toclink" href="#pillow-11-and-djangos-get_image_dimensions"&gt;Pillow 11 and Django&amp;rsquo;s &lt;code&gt;get_image_dimensions&lt;/code&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The goal of &lt;a href="https://github.com/matthiask/django-imagefield"&gt;django-imagefield&lt;/a&gt;
was to deeply verify that Django and Pillow are able to work with uploaded
files; some files can be loaded, their dimensions can be inspected, but
problems happen later when Pillow actually tries resizing or filtering files.
Because of this django-imagefield does more work when images are added to the
system instead of working around it later. (Django doesn&amp;rsquo;t do this on purpose
because doing all this work up-front could be considered a DoS factor.)&lt;/p&gt;
&lt;p&gt;In the last weeks I suddenly got recurring errors from saved files again,
something which shouldn&amp;rsquo;t happen, but obviously did.&lt;/p&gt;
&lt;p&gt;Django wants to read image dimensions when accessing or saving image files (by
the way, always use &lt;code&gt;height_field&lt;/code&gt; and &lt;code&gt;width_field&lt;/code&gt;, otherwise Django will
open and inspect image files even when you&amp;rsquo;re only loading Django models from
the database&amp;hellip;!) and it uses a smart and wonderful&lt;sup id="fnref:fn1"&gt;&lt;a class="footnote-ref" href="#fn:fn1"&gt;1&lt;/a&gt;&lt;/sup&gt; hack to do this: It reads a few hundred bytes from the image file, instructs Pillow to inspect the file and if an exception happens it reads more bytes and tries again. This process relies on the exact type of exceptions raised internally though, and the release of Pillow 11 changed the types&amp;hellip; for some file types only. Fun times.&lt;/p&gt;
&lt;p&gt;The issue had already been reported as
&lt;a href="https://code.djangoproject.com/ticket/33240"&gt;#33240&lt;/a&gt; and is now tracked as &lt;a href="https://github.com/python-pillow/Pillow/issues/8530"&gt;#8530&lt;/a&gt; on the Pillow issue tracker. Let&amp;rsquo;s see what happens.
For now, django-imagefield declares itself to be incompatible with Pillow
11.0.0 so that this error cannot happen.&lt;/p&gt;
&lt;h3 id="rspack-and-lightningcss-shuffled-css-properties"&gt;&lt;a class="toclink" href="#rspack-and-lightningcss-shuffled-css-properties"&gt;rspack and lightningcss shuffled CSS properties&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href="https://rspack.dev/"&gt;rspack&lt;/a&gt; 1.0 started reordering CSS properties which of course lead to CSS properties overriding each other in the incorrect order. That was a fun one to debug. I tracked the issue down to the switch from the swc CSS minimizer to &lt;a href="https://github.com/parcel-bundler/lightningcss"&gt;lightningcss&lt;/a&gt; and submitted a reproduction to the &lt;a href="https://github.com/parcel-bundler/lightningcss/issues/805#issuecomment-2358219597"&gt;issue tracker&lt;/a&gt;. My rust knowledge wasn&amp;rsquo;t up to the task of attempting to submit a fix myself. Luckily, it has been fixed in the meantime.&lt;/p&gt;
&lt;h3 id="rspack-problems"&gt;&lt;a class="toclink" href="#rspack-problems"&gt;rspack problems&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;I have another problem with rspack where I haven&amp;rsquo;t yet tracked down the issue. rspack produces a broken bundle starting with &lt;a href="https://github.com/web-infra-dev/rspack/releases/tag/v1.0.0-beta.2"&gt;1.0.0-beta.2&lt;/a&gt; when compiling a particular project of mine. I have the suspicion that I have misconfigured some stuff related to import paths and yarn workspaces. I have no idea how anyone could have a complete understanding of these things&amp;hellip;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Update:&lt;/strong&gt; The problem was &lt;a href="https://github.com/web-infra-dev/rspack/issues/8027"&gt;#8027&lt;/a&gt;, &lt;code&gt;experiments.css&lt;/code&gt; is quite broken for now.&lt;/p&gt;
&lt;p&gt;Bundlers are complex beasts, and I&amp;rsquo;m happy that I mostly can just use them.&lt;/p&gt;
&lt;h3 id="closing-thoughts"&gt;&lt;a class="toclink" href="#closing-thoughts"&gt;Closing thoughts&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Debugging is definitely a rewarding activity for me. I like tracking stuff down like this. Unfortunately, problems always tend to crop up when time is scarce already, but what can you do.&lt;/p&gt;
&lt;h2 id="releases"&gt;&lt;a class="toclink" href="#releases"&gt;Releases&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Quite a few releases, many of them verifying Python 3.13 and Django 5.1 support (if it hasn&amp;rsquo;t been added already in previous releases). The nicest part: If I remember correctly I didn&amp;rsquo;t have to change anything anywhere, everything just continues to work.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-admin-ordering/"&gt;django-admin-ordering 0.19&lt;/a&gt;: I added support for automatically renumbering objects on page load. This is mostly useful if you already have existing data which isn&amp;rsquo;t ordered yet.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/feincms3-data/"&gt;feincms3-data 0.7&lt;/a&gt;: Made sure that objects are dumped in a deterministic order when dumping. I wanted to compare JSON dumps by hand before and after a big data migration in a customer project and differently ordered dumps made the comparison impossible.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-prose-editor/"&gt;django-prose-editor 0.9&lt;/a&gt;: I updated the ProseMirror packages, and put the editor into read-only mode for &lt;code&gt;&amp;lt;textarea disabled&amp;gt;&lt;/code&gt; elements.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/feincms3-language-sites/"&gt;feincms3-language-sites 0.4&lt;/a&gt;: Finally released the update containing the necessary hook to validate page trees and their unique paths before moving produces integrity errors. Error messages are nicer than internal server errors.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-authlib/"&gt;django-authlib 0.17.2&lt;/a&gt;: The value of the cookie which is used to save the URL where users should be redirected to after authentication wasn&amp;rsquo;t checked for validity when setting it, only when reading it. This meant that attackers could produce invalid header errors in application servers. No real security problem here when using authlib&amp;rsquo;s code.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/feincms3/"&gt;feincms3 5.3&lt;/a&gt;: Minor update which mostly removes support for outdated Python and Django versions.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-imagefield/"&gt;django-imagefield 0.20&lt;/a&gt;: See above.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="footnote"&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id="fn:fn1"&gt;
&lt;p&gt;wonderfully ugly&amp;#160;&lt;a class="footnote-backref" href="#fnref:fn1" title="Jump back to footnote 1 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</summary></entry><entry><title>Weeknotes (2024 week 43)</title><link href="https://406.ch/writing/weeknotes-2024-week-43/" rel="alternate" /><id>https://406.ch/writing/weeknotes-2024-week-43/</id><published>2024-10-23T12:00:00Z</published><updated>2024-10-23T12:00:00Z</updated><summary type="html">&lt;h1 id="weeknotes-2024-week-43"&gt;&lt;a class="toclink" href="#weeknotes-2024-week-43"&gt;Weeknotes (2024 week 43)&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;I had some much needed time off, so this post isn&amp;rsquo;t that long even though &lt;a href="https://406.ch/writing/weeknotes-2024-week-39/"&gt;four weeks have passed since the last entry&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id="from-webpack-to-rspack"&gt;&lt;a class="toclink" href="#from-webpack-to-rspack"&gt;From webpack to rspack&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I&amp;rsquo;ve been really happy with &lt;a href="https://rspack.dev/"&gt;rspack&lt;/a&gt; lately. Converting
webpack projects to rspack is straightforward since it mostly supports the same
configuration, but it&amp;rsquo;s much much faster since it&amp;rsquo;s written in Rust. Rewriting
things in Rust is a recurring theme, but in this case it really helps a lot.
Building the frontend of a larger project of ours consisting of several admin
tools and complete frontend implementations for different teaching materials
only takes 10 seconds now instead of several minutes. That&amp;rsquo;s a big and relevant
difference.&lt;/p&gt;
&lt;p&gt;Newcomers should probably still either use &lt;a href="https://rsbuild.dev/"&gt;rsbuild&lt;/a&gt;,
&lt;a href="https://vite.dev/"&gt;Vite&lt;/a&gt; or maybe no bundler at all. Vanilla JS and browser
support for ES modules is great. That being said, I like cache busting,
optimized bundling and far-future expiry headers in production and hot module
reloading in development a lot, so learning to work with a frontend bundler is
definitely still worth it.&lt;/p&gt;
&lt;h2 id="dark-mode-and-light-mode"&gt;&lt;a class="toclink" href="#dark-mode-and-light-mode"&gt;Dark mode and light mode&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I have been switching themes in my preferred a few times per year in the past. The following ugly bit of vimscript helps switch me the theme each time the sun comes out when working outside:&lt;/p&gt;
&lt;div class="chl"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nv"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;t&lt;/span&gt;:&lt;span class="nv"&gt;light&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="nv"&gt;function&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;FiatLux&lt;/span&gt;&lt;span class="ss"&gt;()&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;t&lt;/span&gt;:&lt;span class="nv"&gt;light&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;:&lt;span class="nv"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;background&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;light&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nv"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;t&lt;/span&gt;:&lt;span class="nv"&gt;light&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;:&lt;span class="nv"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;background&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;dark&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nv"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;t&lt;/span&gt;:&lt;span class="nv"&gt;light&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;endif&lt;/span&gt;
&lt;span class="nv"&gt;endfunction&lt;/span&gt;
&lt;span class="nv"&gt;nnoremap&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;F12&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;:&lt;span class="k"&gt;call&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;FiatLux&lt;/span&gt;&lt;span class="ss"&gt;()&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;CR&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;I&amp;rsquo;m using the &lt;a href="https://devsuite.app/ptyxis/"&gt;Ptyxis&lt;/a&gt; terminal emulator
currently, I haven&amp;rsquo;t investigated yet if there&amp;rsquo;s a shortcut to toggle dark and
light mode for it as well. Using F10 to open the main menu works fine though,
and using the mouse wouldn&amp;rsquo;t be painful either.&lt;/p&gt;
&lt;h2 id="helping-out-in-the-django-forum-and-the-discord"&gt;&lt;a class="toclink" href="#helping-out-in-the-django-forum-and-the-discord"&gt;Helping out in the Django forum and the Discord&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I have found some pleasure in helping out in the &lt;a href="https://forum.djangoproject.com/"&gt;Django
Forum&lt;/a&gt; and in the official &lt;a href="https://discord.gg/xcRH6mN4fa"&gt;Django
Discord&lt;/a&gt;. I sometimes wonder why more people
aren&amp;rsquo;t reading the Django source code when they hit something which looks like
a bug or something which they do not understand. I find Django&amp;rsquo;s source code
very readable and I have found many nuggets within it. I&amp;rsquo;d always recommend
checking the documentation or maybe official help channels first, but the code
is also out there and that fact should be taken advantage of.&lt;/p&gt;
&lt;h2 id="releases"&gt;&lt;a class="toclink" href="#releases"&gt;Releases&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-content-editor/"&gt;django-content-editor 7.1&lt;/a&gt;:
  Fixed a bug where the ordering and region fields were handled incorrectly
  when they appear on one line in the fieldset. Also improved the presentation
  of inlines in unknown regions and clarified the meaning of the move to region
  dropdown. Also, released the improvements from previous patch releases as a
  new minor release because that&amp;rsquo;s what I should have been doing all along.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/form-designer/"&gt;form-designer 0.27&lt;/a&gt;: A user has
  been bitten by &lt;code&gt;slugify&lt;/code&gt; removing cyrillic characters because it only keeps
  ASCII characters around. Here&amp;rsquo;s the wontfixed bug in the Django issue
  tracker: &lt;a href="https://code.djangoproject.com/ticket/8391"&gt;#8391&lt;/a&gt;. I fixed the
  issue by removing the slugification (is that even a word?) when generating
  choices.&lt;/li&gt;
&lt;/ul&gt;</summary></entry><entry><title>Weeknotes (2024 week 39)</title><link href="https://406.ch/writing/weeknotes-2024-week-39/" rel="alternate" /><id>https://406.ch/writing/weeknotes-2024-week-39/</id><published>2024-09-25T12:00:00Z</published><updated>2024-09-25T12:00:00Z</updated><summary type="html">&lt;h1 id="weeknotes-2024-week-39"&gt;&lt;a class="toclink" href="#weeknotes-2024-week-39"&gt;Weeknotes (2024 week 39)&lt;/a&gt;&lt;/h1&gt;
&lt;h2 id="css-for-django-forms"&gt;&lt;a class="toclink" href="#css-for-django-forms"&gt;CSS for Django forms&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Not much going on in OSS land. I have been somewhat active in the official
Django forum, discussing ways to add Python-level hooks to allow adding CSS
classes around form fields and their labels. The discussion on the
&lt;a href="https://forum.djangoproject.com/t/proposal-make-it-easy-to-add-css-classes-to-a-boundfield/32022"&gt;forum&lt;/a&gt;
and on the &lt;a href="https://github.com/django/django/pull/18266"&gt;pull request&lt;/a&gt; goes in
the direction of allowing using custom &lt;code&gt;BoundField&lt;/code&gt; classes per form or even
per project (instead of only per field as is already possible today). This
would allow overriding &lt;code&gt;css_classes&lt;/code&gt;, e.g. to add a simple &lt;code&gt;class="field"&lt;/code&gt;.
Together with &lt;code&gt;:has()&lt;/code&gt; this would probably allow me to skip using custom HTML
templates in 99% of all cases.&lt;/p&gt;
&lt;p&gt;I have also been lurking in the Discord, but more to help and less to promote
my packages and ideas :-)&lt;/p&gt;
&lt;h2 id="releases"&gt;&lt;a class="toclink" href="#releases"&gt;Releases&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django_user_messages/"&gt;django-user-messages 1.1&lt;/a&gt;:
  Added Django 5.0, 5.1 to the CI, and fixed the migrations to no longer
  mention &lt;code&gt;index_together&lt;/code&gt; at all. It seems that squashing the migrations
  wasn&amp;rsquo;t sufficient, I also had to actually delete the old migrations.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/blacknoise/"&gt;blacknoise 1.1&lt;/a&gt;:
  &lt;a href="https://www.starlette.io/"&gt;Starlette&lt;/a&gt;&amp;rsquo;s &lt;code&gt;FileResponse&lt;/code&gt; has gained support
  for the HTTP Range header, allowing me to remove my homegrown implementation
  from the package. The blacknoise implementation is now half as long as it was
  in 1.0.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django_fhadmin/"&gt;django-fhadmin 2.3&lt;/a&gt;: No new
  features, only tweaks to the styling and behavior prompted by updates to
  Django&amp;rsquo;s admin interface.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-cabinet/"&gt;django-cabinet 0.17&lt;/a&gt;: I have
  pruned the CI matrix and accepted a pull request adding a ru translation. I
  feel conflicted about that since I strongly believe that everything is
  political, but I don&amp;rsquo;t know if rejecting translations helps anyone.&lt;/li&gt;
&lt;/ul&gt;</summary></entry><entry><title>django-content-editor now supports nested sections</title><link href="https://406.ch/writing/django-content-editor-now-supports-nested-sections/" rel="alternate" /><id>https://406.ch/writing/django-content-editor-now-supports-nested-sections/</id><published>2024-09-13T12:00:00Z</published><updated>2024-09-13T12:00:00Z</updated><summary type="html">&lt;h1 id="django-content-editor-now-supports-nested-sections"&gt;&lt;a class="toclink" href="#django-content-editor-now-supports-nested-sections"&gt;django-content-editor now supports nested sections&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;&lt;a href="https://django-content-editor.readthedocs.io/"&gt;django-content-editor&lt;/a&gt; (and
it&amp;rsquo;s ancestor FeinCMS) has been the Django admin extension for editing content
consisting of reusable blocks since 2009. In the last years we have more and
more often started &lt;a href="https://feincms3.readthedocs.io/en/latest/guides/rendering.html#grouping-plugins-into-subregions"&gt;automatically grouping related
items&lt;/a&gt;,
e.g. for rendering a sequence of images as a gallery. But, sometimes it&amp;rsquo;s nice
to give editors more control. This has been possible by using blocks which open
a subsection and blocks which close a subsection for a long time, but it hasn&amp;rsquo;t
been friendly to content managers, especially when using nested sections.&lt;/p&gt;
&lt;p&gt;The content editor now has first-class support for such nested sections. Here&amp;rsquo;s
a screenshot showing the nesting:&lt;/p&gt;
&lt;p&gt;&lt;img alt="django-content-editor with sections" src="https://406.ch/assets/20240911-content-editor-sections.png" /&gt;&lt;/p&gt;
&lt;p&gt;Finally it&amp;rsquo;s possible to visually group blocks into sections, collapse those
sections as once and drag and drop whole sections into their place instead of
having to select the involved blocks individually.&lt;/p&gt;
&lt;p&gt;The best part about it is that the content editor still supports all Django
admin widgets, as long as those widgets have support for the Django
administration interface&amp;rsquo;s &lt;a href="https://docs.djangoproject.com/en/latest/ref/contrib/admin/javascript/"&gt;inline form
events&lt;/a&gt;!
Moving DOM nodes around breaks attached JavaScript behaviors, but we do not
actually move DOM nodes around after the initialization &amp;ndash; instead, we use
&lt;a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_flexible_box_layout/Ordering_flex_items"&gt;Flexbox
ordering&lt;/a&gt;
to visually reorder blocks. It&amp;rsquo;s a bit more work than using a ready-made
sortable plugin, but &amp;ndash; as mentioned &amp;ndash; the prize is that we don&amp;rsquo;t break any
other Django admin extensions.&lt;/p&gt;
&lt;h2 id="simple-patterns"&gt;&lt;a class="toclink" href="#simple-patterns"&gt;Simple patterns&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I previously already reacted to a blog post by Lincoln Loop here in my post &lt;a href="https://406.ch/writing/my-reaction-to-the-block-driven-cms-blog-post/"&gt;My
reaction to the block-driven CMS blog
post&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The latest blog post, &lt;a href="https://lincolnloop.com/insights/simple-block-pattern-wagtail-cms/"&gt;Solving the Messy Middle: a Simple Block Pattern for
Wagtail
CMS&lt;/a&gt; was
interesting as well. It dives into the configuration of a
&lt;a href="https://wagtail.org/"&gt;Wagtail&lt;/a&gt; stream field which allows composing content out
of reusable blocks of content (&lt;a href="https://406.ch/writing/i-just-learned-about-wagtail-s-streamfield/"&gt;sounds
familiar!&lt;/a&gt;).
The result is saved in a JSON blob in the database with all the advantages and
disadvantages that entails.&lt;/p&gt;
&lt;p&gt;Now, django-content-editor is a worthy competitor when you do not want to add
another interface to your website besides the user-facing frontend and the
Django administration interface.&lt;/p&gt;
&lt;p&gt;The example from the Lincoln Loop blog post can be replicated quite closely
with django-content-editor by using sections. I&amp;rsquo;m using the
&lt;a href="https://pypi.org/project/django-json-schema-editor/"&gt;django-json-schema-editor&lt;/a&gt;
package for the section plugin since it easily allows adding more fields if
some section type needs it.&lt;/p&gt;
&lt;p&gt;Here&amp;rsquo;s an example model definition:&lt;/p&gt;
&lt;div class="chl"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# Models&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;content_editor.models&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Region&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;create_plugin_base&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django_json_schema_editor.plugins&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;JSONPluginBase&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;feincms3&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;plugins&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Page&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Model&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# You have to define regions; each region gets a tab in the admin interface&lt;/span&gt;
    &lt;span class="n"&gt;regions&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;Region&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;content&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Content&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;

    &lt;span class="c1"&gt;# Additional fields for the page...&lt;/span&gt;

&lt;span class="n"&gt;PagePlugin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;create_plugin_base&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Page&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;RichText&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;plugins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;richtext&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RichText&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PagePlugin&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Image&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;plugins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PagePlugin&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Section&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;JSONPluginBase&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PagePlugin&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;

&lt;span class="n"&gt;AccordionSection&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Section&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;accordion&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;schema&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;type&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;object&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;properties&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;type&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;string&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;}}}},&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;CloseSection&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Section&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;close&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;schema&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;type&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;object&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;properties&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{}}},&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Here&amp;rsquo;s the corresponding admin definition:&lt;/p&gt;
&lt;div class="chl"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# Admin&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;content_editor.admin&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;ContentEditor&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django_json_schema_editor.plugins&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;JSONPluginInline&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;feincms3&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;plugins&lt;/span&gt;

&lt;span class="nd"&gt;@admin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;register&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Page&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;PageAdmin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ContentEditor&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;inlines&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
        &lt;span class="n"&gt;plugins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;richtext&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RichTextInline&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RichText&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="n"&gt;plugins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ImageInline&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="n"&gt;JSONPluginInline&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AccordionSection&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sections&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="n"&gt;JSONPluginInline&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CloseSection&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sections&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The somewhat cryptic &lt;code&gt;sections=&lt;/code&gt; argument says how many levels of sections
the individual blocks open or close.&lt;/p&gt;
&lt;p&gt;To render the content including accordions I&amp;rsquo;d probably use a &lt;a href="https://feincms3.readthedocs.io/en/latest/guides/rendering.html#using-marks"&gt;feincms3
renderer&lt;/a&gt;.
At the time of writing the renderer definition for sections is a bit tricky.&lt;/p&gt;
&lt;div class="chl"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;feincms3.renderer&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;RegionRenderer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;render_in_context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;template_renderer&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;PageRenderer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RegionRenderer&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;handle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;plugins&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;plugins&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;deque&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;plugins&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;yield from&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_handle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;plugins&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;_handle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;plugins&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;in_section&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;plugins&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;isinstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;plugins&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Section&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                &lt;span class="n"&gt;section&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plugins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;popleft&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;section&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;close&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;in_section&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                        &lt;span class="k"&gt;return&lt;/span&gt;
                    &lt;span class="c1"&gt;# Ignore close section plugins when not inside section&lt;/span&gt;
                    &lt;span class="k"&gt;continue&lt;/span&gt;

                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;section&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;accordion&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                    &lt;span class="k"&gt;yield&lt;/span&gt; &lt;span class="n"&gt;render_in_context&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;accordion.html&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                        &lt;span class="s2"&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;accordion&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                        &lt;span class="s2"&gt;&amp;quot;content&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_handle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;plugins&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;in_section&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                    &lt;span class="p"&gt;})&lt;/span&gt;

            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;yield&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;render_plugin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;plugin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;renderer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;PageRenderer&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;renderer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;register&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RichText&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;template_renderer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;plugins/richtext.html&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;renderer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;register&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;template_renderer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;plugins/image.html&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;renderer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;register&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Section&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="closing-thoughts"&gt;&lt;a class="toclink" href="#closing-thoughts"&gt;Closing thoughts&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Sometimes, I think to myself, I&amp;rsquo;ll &amp;ldquo;just&amp;rdquo; write a &amp;ldquo;simple&amp;rdquo; blog post. I get
what I deserve when using those forbidden words. This blog post is neither
short or simple. That being said, the rendering code is a bit tricky, the rest
is quite straightforward. The amount of code in django-content-editor and
feincms3 is reasonable as well. Even though it may look like a lot you&amp;rsquo;ll still
be &lt;a href="https://406.ch/writing/run-less-code-in-production-or-youll-end-up-paying-the-price-later/"&gt;running less code in
production&lt;/a&gt;
than when using comparable solutions built using Django.&lt;/p&gt;</summary></entry><entry><title>Weeknotes (2024 week 37)</title><link href="https://406.ch/writing/weeknotes-2024-week-37/" rel="alternate" /><id>https://406.ch/writing/weeknotes-2024-week-37/</id><published>2024-09-11T12:00:00Z</published><updated>2024-09-11T12:00:00Z</updated><summary type="html">&lt;h1 id="weeknotes-2024-week-37"&gt;&lt;a class="toclink" href="#weeknotes-2024-week-37"&gt;Weeknotes (2024 week 37)&lt;/a&gt;&lt;/h1&gt;
&lt;h2 id="django-debug-toolbar-alpha-with-async-support"&gt;&lt;a class="toclink" href="#django-debug-toolbar-alpha-with-async-support"&gt;django-debug-toolbar alpha with async support!&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I have helped mentoring Aman Pandey who has worked all summer to add async
support to
&lt;a href="https://github.com/jazzband/django-debug-toolbar/"&gt;django-debug-toolbar&lt;/a&gt;.
&lt;a href="https://github.com/tim-schilling"&gt;Tim&lt;/a&gt; has released an alpha which contains
all of the work up to a few days ago. Test it! Let&amp;rsquo;s find the breakages before
the final release.&lt;/p&gt;
&lt;h2 id="dropping-python-39-from-my-projects"&gt;&lt;a class="toclink" href="#dropping-python-39-from-my-projects"&gt;Dropping Python 3.9 from my projects&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I have read &lt;a href="https://noumenal.es/posts/the-only-green-python/yLw/"&gt;Carlton&amp;rsquo;s post about the only green Python release&lt;/a&gt; and have started dropping Python 3.9 support from many of the packages I maintain. This is such a good point:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;[&amp;hellip;] Im also thinking about it in terms of reducing the number of Python versions we support in CI. It feels like a lot of trees to support 5 full versions of Python for their entire life. &lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="releases"&gt;&lt;a class="toclink" href="#releases"&gt;Releases&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-debug-toolbar/5.0.0a0/"&gt;django-debug-toolbar 5.0.0a0&lt;/a&gt;: See above.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/form-designer/"&gt;form-designer 0.26.2&lt;/a&gt;: The values
  of choice fields are now returned as-is when sending mails or exporting form
  submissions instead of only returning the slugified version.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-authlib/"&gt;django-authlib 0.17.1&lt;/a&gt;: The
  &lt;a href="https://406.ch/writing/keep-content-managers-admin-access-up-to-date-with-role-based-permissions/"&gt;role-based permissions
  backend&lt;/a&gt;
  had a bug where it wouldn&amp;rsquo;t return all available permissions in all
  circumstances, leading to empty navigation sidebars in the Django
  administration. This has been fixed.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/feincms3/"&gt;feincms3 5.2.3&lt;/a&gt;: Bugfix release, the
  page moving interface is no longer hidden by an expanded navigation sidebar.
  I almost always turn off the sidebar in my projects so I haven&amp;rsquo;t noticed
  this.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-prose-editor/"&gt;django-prose-editor 0.8.1&lt;/a&gt;:
  Contains the most recent ProseMirror updates and bugfixes.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-content-editor/"&gt;django-content-editor
  7.0.10&lt;/a&gt;: Now supports
  sections. Separate blog post coming up!&lt;/li&gt;
&lt;/ul&gt;</summary></entry><entry><title>Weeknotes (2024 week 35)</title><link href="https://406.ch/writing/weeknotes-2024-week-35/" rel="alternate" /><id>https://406.ch/writing/weeknotes-2024-week-35/</id><published>2024-08-28T12:00:00Z</published><updated>2024-08-28T12:00:00Z</updated><summary type="html">&lt;h1 id="weeknotes-2024-week-35"&gt;&lt;a class="toclink" href="#weeknotes-2024-week-35"&gt;Weeknotes (2024 week 35)&lt;/a&gt;&lt;/h1&gt;
&lt;h2 id="getting-deep-into-htmx-and-django-template-partials"&gt;&lt;a class="toclink" href="#getting-deep-into-htmx-and-django-template-partials"&gt;Getting deep into htmx and django-template-partials&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I have been skeptical about &lt;a href="https://htmx.org/"&gt;htmx&lt;/a&gt; for some time because basically everything the library does is straightforward to do myself with a few lines of JavaScript. I am a convert now because, really, adding a few HTML attributes is nicer than copy pasting a few lines of JavaScript. Feels good.&lt;/p&gt;
&lt;p&gt;The combination of htmx with &lt;a href="https://github.com/carltongibson/django-template-partials/"&gt;django-template-partials&lt;/a&gt; is great as well. I didn&amp;rsquo;t know I had been missing template partials until I started using them. Includes are still useful, but replacing some of them with partials makes working on the project much more enjoyable.&lt;/p&gt;
&lt;p&gt;I haven&amp;rsquo;t yet had a use for &lt;a href="https://django-htmx.readthedocs.io/"&gt;django-htmx&lt;/a&gt; but I may yet surprise myself.&lt;/p&gt;
&lt;h2 id="releases"&gt;&lt;a class="toclink" href="#releases"&gt;Releases&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-authlib/"&gt;django-authlib 0.17&lt;/a&gt;: django-authlib bundles &lt;code&gt;authlib.little_auth&lt;/code&gt; which offers an user model which uses the email address as the username. I have also introduced the concept of &lt;a href="https://406.ch/writing/keep-content-managers-admin-access-up-to-date-with-role-based-permissions/"&gt;roles instead of permissions&lt;/a&gt;; now I have reorganized the user admin fieldset to hide user permissions altogether. Group permissions are still available as are roles. I&amp;rsquo;m personally convinced that user permissions were a mistake.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/feincms3-forms/"&gt;feincms3-forms 0.5&lt;/a&gt;: Allowed setting a maximum length for the bundled URL and email fields through the Django administration interface.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-content-editor/"&gt;django-content-editor 7.0.7&lt;/a&gt;: Fixed a bug where plugins with several fieldsets weren&amp;rsquo;t collapsed completely.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-imagefield/"&gt;django-imagefield 0.19.1&lt;/a&gt;: Allowed deactivating autogeneration of thumbnails completely through the &lt;code&gt;IMAGEFIELD_AUTOGENERATE&lt;/code&gt; setting. This is very useful for batch processing. Also, documented all available settings.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-prose-editor/"&gt;django-prose-editor 0.8&lt;/a&gt;: Added support for translating the interface elements and for restricting the available heading levels in the UI.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/form-designer/"&gt;form-designer 0.25&lt;/a&gt;: Fixed the type of the author field for the send-to-author processing action.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/feincms3/"&gt;feincms3 5.2.2&lt;/a&gt;: Added support for embedding &lt;a href="https://www.srf.ch/play/tv"&gt;SRF play&lt;/a&gt; external content. They do not support oEmbed unfortunately.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/feincms3-cookiecontrol/"&gt;feincms3-cookiecontrol 1.5.3&lt;/a&gt;: Added support for SRF play embeddings as well. The difference is that the feincms3-cookiecontrol embedding requires consent before embedding external content.&lt;/li&gt;
&lt;/ul&gt;</summary></entry><entry><title>How I handle versioning</title><link href="https://406.ch/writing/how-i-handle-versioning/" rel="alternate" /><id>https://406.ch/writing/how-i-handle-versioning/</id><published>2024-08-20T12:00:00Z</published><updated>2024-08-20T12:00:00Z</updated><summary type="html">&lt;h1 id="how-i-handle-versioning"&gt;&lt;a class="toclink" href="#how-i-handle-versioning"&gt;How I handle versioning&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;I have been reading up on versioning methods a bit, and I noticed that I never
shared my a bit unorthodox versioning method. I previously wrote about my &lt;a href="https://406.ch/writing/my-rules-for-releasing-open-source-software/"&gt;rules for releasing open source software&lt;/a&gt; but skipped everything related to versioning.&lt;/p&gt;
&lt;p&gt;I use something close to the ideas of &lt;a href="https://semver.org/"&gt;semantic versioning&lt;/a&gt; but it&amp;rsquo;s not quite that. Note that the versioning scheme has nothing to do with production readiness, it&amp;rsquo;s more about communicating the state of the project.&lt;/p&gt;
&lt;h2 id="00x-everything-breaks"&gt;&lt;a class="toclink" href="#00x-everything-breaks"&gt;0.0.x &amp;ndash; Everything breaks&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I don&amp;rsquo;t trust my choices a lot. Everything may radically change, and I may also abandon the project with no hard feelings.&lt;/p&gt;
&lt;h2 id="010-changelogging"&gt;&lt;a class="toclink" href="#010-changelogging"&gt;0.1.0 &amp;ndash; Changelogging&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I generally start writing release notes or rather a &lt;a href="https://en.wikipedia.org/wiki/Changelog"&gt;Changelog&lt;/a&gt;, since writing full release notes is much more work. You absolutely have to test the software and I do not guarantee anything related to backwards compatibility &amp;ndash; just that you&amp;rsquo;ll know about breaking changes when you read the CHANGELOG.&lt;/p&gt;
&lt;h2 id="x-bugfixes-and-pure-additions"&gt;&lt;a class="toclink" href="#x-bugfixes-and-pure-additions"&gt;?.?.x &amp;ndash; Bugfixes and pure additions&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Strictly speaking, patch version increments are only for bugfixes. However, when I add new features which are purely additional to the package or if there&amp;rsquo;s no way (famous last words) that anything will break, I&amp;rsquo;ll upload a patch release.&lt;/p&gt;
&lt;p&gt;Sometimes it might be better to increment the minor version, yes. But, being very lazy, I sometimes only want to add a line to the CHANGELOG instead of adding a new heading for the new release. Also, if I don&amp;rsquo;t quickly release new additions there&amp;rsquo;s a real danger that I&amp;rsquo;ll only come back to the project weeks or months later, and I don&amp;rsquo;t want anyone (myself included) waiting on these updates. Also, if I inadvertently introduced new bugs it&amp;rsquo;s better to fix them quickly instead of forgetting about it first and having to rediscover the buggy code later.&lt;/p&gt;
&lt;h2 id="100-im-happy"&gt;&lt;a class="toclink" href="#100-im-happy"&gt;1.0.0 &amp;ndash; I&amp;rsquo;m happy&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I&amp;rsquo;m happy with the package and I commit to start using semver more properly. If I have to (or want to) break backwards compatibility you get a migration path, especially if I need it myself. Which is often the case since I&amp;rsquo;m maintaining dozens of Django-based websites and webapps, and I&amp;rsquo;m always &lt;a href="https://en.wikipedia.org/wiki/Eating_your_own_dog_food"&gt;dogfooding&lt;/a&gt; my stuff.&lt;/p&gt;
&lt;p&gt;The pure additions case from the last section still applies, since slapping a 1.0 version on something doesn&amp;rsquo;t suddenly make me less lazy.&lt;/p&gt;
&lt;h2 id="outliers"&gt;&lt;a class="toclink" href="#outliers"&gt;Outliers&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://github.com/feincms/feincms"&gt;FeinCMS&lt;/a&gt; uses a variant of &lt;a href="https://calver.org/"&gt;calendar versioning&lt;/a&gt;; the version at the time of writing is 24.8.2 which means the second release in August 2024.&lt;/p&gt;
&lt;p&gt;There are probably other outliers I forgot about.&lt;/p&gt;</summary></entry><entry><title>Weeknotes (2024 week 33)</title><link href="https://406.ch/writing/weeknotes-2024-week-33/" rel="alternate" /><id>https://406.ch/writing/weeknotes-2024-week-33/</id><published>2024-08-14T12:00:00Z</published><updated>2024-08-14T12:00:00Z</updated><summary type="html">&lt;h1 id="weeknotes-2024-week-33"&gt;&lt;a class="toclink" href="#weeknotes-2024-week-33"&gt;Weeknotes (2024 week 33)&lt;/a&gt;&lt;/h1&gt;
&lt;h2 id="partying"&gt;&lt;a class="toclink" href="#partying"&gt;Partying&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;It&amp;rsquo;s summer, it&amp;rsquo;s hot, and it&amp;rsquo;s dance week. &lt;a href="https://lethargy.ch/"&gt;Lethargy&lt;/a&gt; is over, &lt;a href="https://www.junglestreetgroove.ch/"&gt;Jungle Street Groove&lt;/a&gt; is coming up. Good times.&lt;/p&gt;
&lt;h2 id="releases"&gt;&lt;a class="toclink" href="#releases"&gt;Releases&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-json-schema-editor/"&gt;django-json-schema-editor 0.1&lt;/a&gt;: I have finally left the alpha versioning. I&amp;rsquo;m still not committing to backwards compatibility, but I have started writing a CHANGELOG.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-prose-editor/"&gt;django-prose-editor 0.7.1&lt;/a&gt;: Thanks to Carlton&amp;rsquo;s pull request I have finally cleaned up the CSS somewhat and made overriding the styles more agreeable when using the editor outside the Django administration. The confusing active state of menubar buttons has also been rectified. &lt;a href="https://django-prose-editor.readthedocs.io/"&gt;Docs are now available on Read the Docs.&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-imagefield/"&gt;django-imagefield 0.19&lt;/a&gt;: django-imagefield can now be used with proxy models. Previously, thumbnails weren&amp;rsquo;t generated or deleted when saving proxy models because the signal handlers would only be called if the &lt;code&gt;sender&lt;/code&gt; matches exactly. I have already debugged this before, but have forgotten about it again. The ticket is really old for this, and fixing it isn&amp;rsquo;t easy since it&amp;rsquo;s unclear what should happen (&lt;a href="https://code.djangoproject.com/ticket/9318"&gt;#9318&lt;/a&gt;).&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django_canonical_domain/"&gt;django-canonical-domain 0.11&lt;/a&gt;: django-canonical-domain has gained support for excluding additional domains from the canonical domain redirect. django-canonical-domain is used to redirect users to HTTPS (optionally) and to a particular canonical domain (as the name says). But sometimes you have auxiliary domains, e.g. for an API service, which shouldn&amp;rsquo;t be redirected. The package can now be used in these scenarios as well.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/FeinCMS/"&gt;FeinCMS 24.8.2&lt;/a&gt;: The venerable FeinCMS, now more than 15 years old. The thumbnailing support had a bug where it tried saving JPEGs using RGBA (which obviously doesn&amp;rsquo;t work). This has been fixed.&lt;/li&gt;
&lt;/ul&gt;</summary></entry><entry><title>Weeknotes (2024 week 31)</title><link href="https://406.ch/writing/weeknotes-2024-week-31/" rel="alternate" /><id>https://406.ch/writing/weeknotes-2024-week-31/</id><published>2024-07-31T12:00:00Z</published><updated>2024-07-31T12:00:00Z</updated><summary type="html">&lt;h1 id="weeknotes-2024-week-31"&gt;&lt;a class="toclink" href="#weeknotes-2024-week-31"&gt;Weeknotes (2024 week 31)&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;I have missed almost two months of weeknotes. I&amp;rsquo;ve got some catching up to do.
I have tried writing a larger piece on my thoughts about CMS, but with
everything going on in my personal and work life I haven&amp;rsquo;t made much progress.&lt;/p&gt;
&lt;p&gt;This weeknotes entry is me trying to get back into the groove of writing (and
publishing!) regularly.&lt;/p&gt;
&lt;h2 id="django-prose-editor"&gt;&lt;a class="toclink" href="#django-prose-editor"&gt;&lt;a href="https://github.com/matthiask/django-prose-editor/"&gt;django-prose-editor&lt;/a&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I have previously written about the
&lt;a href="https://prosemirror.net/"&gt;ProseMirror&lt;/a&gt;-based editor for Django websites
&lt;a href="https://406.ch/writing/django-prose-editor-prose-editing-component-for-the-django-admin/"&gt;here&lt;/a&gt;.
I have continued working on the project in the meantime. Apart from bugfixes
the big new feature is the support for showing typographic characters. For now
the editor supports showing non-breaking spaces and soft hyphens. The project
seems to get a little more interest after the deprecation of django-ckeditor
has become more well known and the project has even received a contribution by
someone else. It&amp;rsquo;s always a lovely moment when this happens.&lt;/p&gt;
&lt;h2 id="django-json-schema-editor"&gt;&lt;a class="toclink" href="#django-json-schema-editor"&gt;&lt;a href="https://github.com/matthiask/django-json-schema-editor"&gt;django-json-schema-editor&lt;/a&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Still alpha. Updated the vendorized JSON editor and fixed the integration into
Django to not throw errors with the newer version.&lt;/p&gt;
&lt;p&gt;Foreign key fields now support describing the referenced value similar to the
raw ID fields functionality. Added optional support for using &lt;code&gt;"format":
"prose"&lt;/code&gt; to use the django-prose-editor to edit individual fields. JSON
plugins for the content editor are now downcasted into their proxy models
automatically. This is especially useful with the feincms3 changes mentioned
below. (You do not have to use either django-content-editor or feincms3 to use
this package!)&lt;/p&gt;
&lt;p&gt;The following screenshot shows the prose editor integration; the mentioned
foreign key field description isn&amp;rsquo;t visible yet here.&lt;/p&gt;
&lt;p&gt;&lt;img alt="A screenshot of the JSON editor including the prose editor" src="https://406.ch/assets/20240731-json-editor.png" /&gt;&lt;/p&gt;
&lt;h2 id="traduire"&gt;&lt;a class="toclink" href="#traduire"&gt;&lt;a href="https://github.com/matthiask/traduire"&gt;Traduire&lt;/a&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Traduire (french for translate) is a web-based platform for editing gettext
translations.&lt;/p&gt;
&lt;p&gt;It is intended as a replacement for Transifex, Weblate and comparable products.
It is geared towards small teams or agencies which want to allow their
customers and their less technical team members to update translations.&lt;/p&gt;
&lt;p&gt;Traduire profits from the great work done on
&lt;a href="https://github.com/mbi/django-rosetta/"&gt;django-rosetta&lt;/a&gt;. I would still be
using Rosetta if it would work when used with a container orchestator such as
Kubernetes. Since all application storage is ephemeral that doesn&amp;rsquo;t work,
translation editing and deployment have to be separated.&lt;/p&gt;
&lt;p&gt;&lt;img alt="A screenshot of the Traduire interface" src="https://406.ch/assets/20240731-traduire.png" /&gt;&lt;/p&gt;
&lt;p&gt;It is built using Django and relies on &lt;a href="https://pypi.org/project/polib/"&gt;polib&lt;/a&gt;
to do the heavy lifting.&lt;/p&gt;
&lt;p&gt;This is a project which might also be interesting for others. I would
especially appreciate it if someone could contribute an easier way to get it up
and running, e.g. using a Docker Compose configuration or something. I am using
Kubernetes and GitOps to host it, but that&amp;rsquo;s not straightforward at all.
Really, all that&amp;rsquo;s needed to run it is a Django host with any database which is
supported by Django. I prefer using PostgreSQL because I have it, but sqlite
etc. work just as well.&lt;/p&gt;
&lt;h2 id="releases-since-the-second-week-of-june"&gt;&lt;a class="toclink" href="#releases-since-the-second-week-of-june"&gt;Releases since the second week of June&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-translated-fields/"&gt;django-translated-fields 0.13&lt;/a&gt;:
  Nothing much except for CI and pre-commit updates. The implementation
  continues to be rock-solid and basically unchanged.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-content-editor/"&gt;django-content-editor 7.0.6&lt;/a&gt;:
  Tweaks and fixes to the new interface. Added better scrolling behavior when
  dragging content around. The editor now also supports colorized icons which
  helps quickly understanding the structure of some content when there are many
  plugins.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/blacknoise/"&gt;blacknoise 1.0.2&lt;/a&gt;:
  Fixed a few bugs in the &lt;code&gt;blacknoise.compress&lt;/code&gt; utility and started running
  the testsuite on GitHub actions.
  &lt;a href="https://github.com/evansd/whitenoise/"&gt;whitenoise&lt;/a&gt; has been friendly-forked
  as &lt;a href="https://github.com/Archmonger/ServeStatic"&gt;ServeStatic&lt;/a&gt; and I&amp;rsquo;m
  definitely having a close look at this project as well, but blacknoise is
  simple and works well, so I&amp;rsquo;m not convinced that switching back to the much
  larger project (in terms of amounts of code) is an improvement now.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-authlib/"&gt;django-authlib&lt;/a&gt;:
  Minor bugfixes.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/feincms3/"&gt;feincms3&lt;/a&gt;:
  Allowed registering plugin models with the renderer which aren&amp;rsquo;t supposed to
  be fetched from the database. This is especially useful when used together
  with JSON plugins, where the individual JSON plugins are created as proxies
  for the underlying Django model and fetched all at once. Disabled the version
  check on our CKEditor plugin. Still, really stop using CKEditor 4 if you want
  to use maintained software.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/FeinCMS/"&gt;FeinCMS 24.7.1&lt;/a&gt;:
  Small bugfixes, and made the Read the Docs build work correctly.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-debug-toolbar/"&gt;django-debug-toolbar 4.4.x&lt;/a&gt;:
  The toolbar continues to be a nice project to work on. Fixed a few edge cases
  in the new alerts panel.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-admin-ordering/"&gt;django-admin-ordering 0.18.2&lt;/a&gt;:
  The value of &lt;code&gt;ordering_field&lt;/code&gt; now has additional sanity checks.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-cabinet/"&gt;django-cabinet 0.16&lt;/a&gt;:
  cabinet now supports exporting a folder as a ZIP file while preserving the
  structure you see in the CMS instead of the structure on the file system. The
  inline upload form has been dropped from the &lt;code&gt;CabinetForeignKey&lt;/code&gt; widget
  because the folder dropdown slowed down the page a lot when used on a site
  with many folders. Using the raw ID fields popup isn&amp;rsquo;t that bad.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-prose-editor/"&gt;django-prose-editor 0.6.2&lt;/a&gt;:
  See above.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-json-schema-editor/"&gt;django-json-schema-editor 0.0.28&lt;/a&gt;:
  See above.&lt;/li&gt;
&lt;/ul&gt;</summary></entry><entry><title>Weeknotes (2024 week 23)</title><link href="https://406.ch/writing/weeknotes-2024-week-23/" rel="alternate" /><id>https://406.ch/writing/weeknotes-2024-week-23/</id><published>2024-06-07T12:00:00Z</published><updated>2024-06-07T12:00:00Z</updated><summary type="html">&lt;h1 id="weeknotes-2024-week-23"&gt;&lt;a class="toclink" href="#weeknotes-2024-week-23"&gt;Weeknotes (2024 week 23)&lt;/a&gt;&lt;/h1&gt;
&lt;h2 id="switching-everything-from-pip-to-uv"&gt;&lt;a class="toclink" href="#switching-everything-from-pip-to-uv"&gt;Switching everything from pip to uv&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Enough said. I&amp;rsquo;m always astonished how fast computers can be.&lt;/p&gt;
&lt;h2 id="releases"&gt;&lt;a class="toclink" href="#releases"&gt;Releases&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-admin-ordering/"&gt;django-admin-ordering
  0.18&lt;/a&gt;: Added a database
  index to the ordering field since we&amp;rsquo;re always sorting by it.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-prose-editor/"&gt;django-prose-editor 0.4&lt;/a&gt;:
  Dropped the jQuery dependency making it possible to use the editor outside
  the Django administration interface without annoying JavaScript errors.
  Allowed additional heading levels and moved the block type buttons into a
  popover.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-debug-toolbar/"&gt;django-debug-toolbar 4.4.2&lt;/a&gt;:
  I enjoy working on this important piece of software very much.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-email-hosts/"&gt;django-email-hosts 0.2.1&lt;/a&gt;:
  Added a command analogous to &lt;code&gt;./manage.py sendtestemail&lt;/code&gt; so that it&amp;rsquo;s
  possible to easily test the different configured email backends.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/feincms3/"&gt;feincms3 5.0&lt;/a&gt;: I completely reworked the
  move node action; previously it opened a new page where you could see all
  possible targets; now you can cut a page and paste it somewhere else. The
  advantages of the new interface is that you don&amp;rsquo;t leave the changelist and
  can still profit from all its features while moving pages around.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/feincms3-sites/"&gt;feincms3-sites 0.21&lt;/a&gt;: A new
  release taking advantage of a new hook in feincms3 7.0 so that the new moving
  interface works.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-authlib/"&gt;django-authlib 0.16.5&lt;/a&gt;: authlib
  now shows a welcome message when authenticating using admin OAuth2. It&amp;rsquo;s nice
  and helps with debugging strange authentication failures.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-content-editor/"&gt;django-content-editor 7.0&lt;/a&gt;:
  I reworked the UI. The sidebar is gone, instead there are nice buttons in the
  place where you can add new plugins; the plugins appear in a nice grid
  instead of a list, which looks much better once you have more than just a few
  plugin types available. Also, plugin type icons are now shown in the plugin
  forms. I think it looks much better than before.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/feincms3-cookiecontrol/"&gt;feincms3-cookiecontrol
  1.5.2&lt;/a&gt;: I didn&amp;rsquo;t contribute
  anything to this release which is also a nice experience for a change. The
  Google consent mode integration has been improved and simplified.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-json-schema-editor/"&gt;django-json-schema-editor
  0.0.22&lt;/a&gt;: Various
  small-ish improvements. I should really start using higher version numbers,
  but not having to commit to anything also feels great.  That being said, the
  editor is in active use in several projects, so maybe I&amp;rsquo;m deceiving myself.&lt;/li&gt;
&lt;/ul&gt;</summary></entry><entry><title>Workbench: Coffee time!</title><link href="https://406.ch/writing/workbench-coffee-time/" rel="alternate" /><id>https://406.ch/writing/workbench-coffee-time/</id><published>2024-05-24T12:00:00Z</published><updated>2024-05-24T12:00:00Z</updated><summary type="html">&lt;h1 id="workbench-coffee-time"&gt;&lt;a class="toclink" href="#workbench-coffee-time"&gt;Workbench: Coffee time!&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;I have written about &lt;a href="https://406.ch/writing/workbench-the-django-based-agency-software/"&gt;the Workbench agency
software&lt;/a&gt; a
few weeks back.&lt;/p&gt;
&lt;p&gt;Back when we were using Slack at &lt;a href="https://feinheit.ch/"&gt;Feinheit&lt;/a&gt; we used a
Donut bot to generate randomized invites for a coffee break. &lt;a href="https://406.ch/writing/why-we-switched-from-slack-to-discord-at-work/"&gt;We lost that bot
when we switched to
Discord&lt;/a&gt;.
I searched some time for an equivalent bot for Discord but couldn&amp;rsquo;t find any,
so like any self-respecting nerd, break lover and NIH-sufferer I reimplemented
the functionality as a part of our agency software.&lt;/p&gt;
&lt;p&gt;The first version generated totally random pairings without any history; I
thought that maybe this would be good enough, but of course I received an
invite for a coffee with the exact same person in the first two invitations.
Even though I did enjoy the break both times this motivated me to put some
effort into a better solution :-)&lt;/p&gt;
&lt;p&gt;The result of this work is the &lt;a href="https://github.com/matthiask/workbench/blob/a14d8b9560def7a4e2bbf7531eb6108f734568db/workbench/accounts/tasks.py#L57"&gt;&lt;code&gt;coffee_invites()&lt;/code&gt; function&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;There are two main parts to the generator:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;It randomly generates twenty pairings from all participants; it prefers
  groups of two except for the last group which may contain three people.&lt;/li&gt;
&lt;li&gt;It loads old pairings from the database and gives higher penalties to equal
  pairings depending on the time which has passed since the last time.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So, it&amp;rsquo;s not mathematically perfect, but all imbalances will cancel out over a
long time. I experimented with the discounting factor and the number of random
pairings it generates upfront. The values in the code seem to work fine.&lt;/p&gt;
&lt;p&gt;Sometimes it&amp;rsquo;s simple stuff like this which gets me going and reignites the
love for programming. Like a small puzzle.&lt;/p&gt;</summary></entry><entry><title>Weeknotes (2024 week 21)</title><link href="https://406.ch/writing/weeknotes-2024-week-21/" rel="alternate" /><id>https://406.ch/writing/weeknotes-2024-week-21/</id><published>2024-05-22T12:00:00Z</published><updated>2024-05-22T12:00:00Z</updated><summary type="html">&lt;h1 id="weeknotes-2024-week-21"&gt;&lt;a class="toclink" href="#weeknotes-2024-week-21"&gt;Weeknotes (2024 week 21)&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;There have been times when work has been more enjoyable than in the last few
weeks. It feels more stressful than at other times, and this mostly has to do
with particular projects. I hope I&amp;rsquo;ll be able to move on soon.&lt;/p&gt;
&lt;h2 id="blacknoise"&gt;&lt;a class="toclink" href="#blacknoise"&gt;blacknoise&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I have released &lt;a href="https://pypi.org/project/blacknoise/"&gt;blacknoise 1.0&lt;/a&gt;. It&amp;rsquo;s an
ASGI app for static file serving inspired by
&lt;a href="https://github.com/evansd/whitenoise/"&gt;whitenoise&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The 1.0 version number is only a big step in versioning terms, not much has
happened with the code. It&amp;rsquo;s a tiny little well working piece of software which
has been running in production for some time without any hickups. The biggest
recent change is that I have parallelized the gzip and brotli compression step;
this makes building images using whitenoise more painful because there the wait
is really really long sometimes. &lt;a href="https://github.com/evansd/whitenoise/pull/484"&gt;A pull request fixing this
exists&lt;/a&gt;, but it hasn&amp;rsquo;t moved
forwards in months.&lt;/p&gt;
&lt;p&gt;I have written a longer post about it earlier this year
&lt;a href="https://406.ch/writing/blacknoise-asgi-app-for-static-file-serving/"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id="releases"&gt;&lt;a class="toclink" href="#releases"&gt;Releases&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/feincms3-cookiecontrol/"&gt;feincms3-cookiecontrol 1.5&lt;/a&gt;: Code golfing. Added backwards compatibility with old Django versions so that I can use it for old projects. Also includes optional support for Google consent management.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django_fast_export/"&gt;django-fast-export 0.1.1&lt;/a&gt;: This is basically a repackaging of the streaming CSV view from Django&amp;rsquo;s documentation as a reusable class. I have switched to using an iterator so that I can export even larger datasets.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-json-schema-editor/"&gt;django-json-schema-editor 0.0.18&lt;/a&gt;: Still alpha versioned but used in production in various projects. I should really release an 1.0 version, but there are no integration tests at all. Mainly visual tweaks in this update.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-content-editor/"&gt;django-content-editor 6.5&lt;/a&gt;: Better handling of templates and regions when a particular editor instance only shows a subset of configured templates. Disallowed adding plugins when in an unknown region. It&amp;rsquo;s funny how many edge cases exist in software as old as this.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/blacknoise/"&gt;blacknoise 1.0&lt;/a&gt;: See above.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/html-sanitizer/"&gt;html-sanitizer 2.4.4&lt;/a&gt;: Fixed edge cases with whitespace handling when merging elements.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/feincms3-data/"&gt;feincms3-data 0.6.1&lt;/a&gt;: Allowed &lt;code&gt;./manage.py f3loaddata -&lt;/code&gt; to load JSON data from stdin.&lt;/li&gt;
&lt;/ul&gt;</summary></entry><entry><title>Weeknotes (2024 week 18)</title><link href="https://406.ch/writing/weeknotes-2024-week-18/" rel="alternate" /><id>https://406.ch/writing/weeknotes-2024-week-18/</id><published>2024-05-03T12:00:00Z</published><updated>2024-05-03T12:00:00Z</updated><summary type="html">&lt;h1 id="weeknotes-2024-week-18"&gt;&lt;a class="toclink" href="#weeknotes-2024-week-18"&gt;Weeknotes (2024 week 18)&lt;/a&gt;&lt;/h1&gt;
&lt;h2 id="google-summer-of-code-has-begun"&gt;&lt;a class="toclink" href="#google-summer-of-code-has-begun"&gt;Google Summer of Code has begun&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We have a student helping out with adding async support to the &lt;a href="https://github.com/jazzband/django-debug-toolbar/"&gt;Django Debug
Toolbar&lt;/a&gt;. It&amp;rsquo;s great that
someone can spend some concentrated time to work on this. Tim and others have
done all the necessary preparation work, I&amp;rsquo;m only helping from the sidelines so
don&amp;rsquo;t thank me.&lt;/p&gt;
&lt;h2 id="bike-to-work"&gt;&lt;a class="toclink" href="#bike-to-work"&gt;Bike to Work&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Two teams from my company are participating in the &lt;a href="https://www.biketowork.ch/"&gt;Bike to Work Challenge
2024&lt;/a&gt;. It&amp;rsquo;s what I do anyway (if I&amp;rsquo;m not working
from home) but maybe it helps build others some motivation to get on the
bicycle once more. Public transports in the city where I live are great but
I&amp;rsquo;ll always take the bike when I can. I also went on my first mountain bike
ride in a few months yesterday, good fun.&lt;/p&gt;
&lt;h2 id="json-blobs-and-referential-integrity"&gt;&lt;a class="toclink" href="#json-blobs-and-referential-integrity"&gt;JSON blobs and referential integrity&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The &lt;a href="https://github.com/matthiask/django-json-schema-editor/"&gt;django-json-schema-editor&lt;/a&gt; has gained support for referencing Django models. Here&amp;rsquo;s an example schema excerpt:&lt;/p&gt;
&lt;div class="chl"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;articles&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;type&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;array&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;format&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;table&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;_&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;articles&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;minItems&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;maxItems&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;items&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;type&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;string&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;_&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;article&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;format&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;foreign_key&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;options&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;url&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/admin/articles/article/?_popup=1&amp;amp;_to_field=id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The ID field is stringly typed; using an integer directly wouldn&amp;rsquo;t work because
the empty string isn&amp;rsquo;t a valid integer.&lt;/p&gt;
&lt;p&gt;The problem with referencing models in this way is that there&amp;rsquo;s no way to know
if the referenced object is still around or not, or even to protect it against
deletion. The bundled django-content-editor &lt;code&gt;JSONPlugin&lt;/code&gt; now supports
automatically generating a &lt;code&gt;ManyToManyField&lt;/code&gt; with a &lt;code&gt;through&lt;/code&gt; model which
protects articles from deletion as long as they are referenced from a
&lt;code&gt;JSONPlugin&lt;/code&gt; instance. The &lt;code&gt;register_reference&lt;/code&gt; line creates the mentioned
model with an &lt;code&gt;on_delete=models.PROTECT&lt;/code&gt; foreign key to articles and a
&lt;code&gt;post_save&lt;/code&gt; handler which updates said references.&lt;/p&gt;
&lt;div class="chl"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;django_json_schema_editor.plugins&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;JSONPluginBase&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;register_reference&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;articles.models&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Article&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nc"&gt;JSONPlugin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;JSONPluginBase&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;pass&lt;/span&gt;

&lt;span class="n"&gt;register_reference&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;JSONPlugin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;articles&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Article&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="releases-since-the-beginning-of-april"&gt;&lt;a class="toclink" href="#releases-since-the-beginning-of-april"&gt;Releases since the beginning of April&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-json-schema-editor/"&gt;django-json-schema-editor 0.0.14&lt;/a&gt;: See above. Also, some styling work and a patch update to the vendorized json-editor.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-content-editor/"&gt;django-content-editor 6.4.6&lt;/a&gt;: Many small stylistic fixes. The target indicator when dragging plugins is now also shown when plugins are collapsed. It&amp;rsquo;s now possible to directly drag a plugin to the end, and not just to the second to last position.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-prose-editor/"&gt;django-prose-editor 0.3.4&lt;/a&gt;: Switched to the nh3 sanitizer because it&amp;rsquo;s faster and because ProseMirror never emits HTML which has to be cleaned up first. Stopped generating menu items for nodes and marks which aren&amp;rsquo;t in the schema. Added the possibility to reduce the functionality per editor instance. Small tweaks and fixes.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-tree-queries/"&gt;django-tree-queries 0.19&lt;/a&gt;: Added support for pre-filtering the tree (much more efficient when only querying a part of the tree). Added support for adding additional fields to the CTE so that you can collect values from ancestors for other fields than the default fields too.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/FeinCMS/"&gt;FeinCMS 24.4.2&lt;/a&gt;: Added support for webp images. Fixed a few of the admin list filters to work with Django 5.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-cabinet/"&gt;django-cabinet 0.14.3&lt;/a&gt;: Fixed the support for the &lt;code&gt;extra_context&lt;/code&gt; argument to our &lt;code&gt;changelist_view&lt;/code&gt; implementation.&lt;/li&gt;
&lt;/ul&gt;</summary></entry><entry><title>Workbench, the Django-based agency software</title><link href="https://406.ch/writing/workbench-the-django-based-agency-software/" rel="alternate" /><id>https://406.ch/writing/workbench-the-django-based-agency-software/</id><published>2024-04-24T12:00:00Z</published><updated>2024-04-24T12:00:00Z</updated><summary type="html">&lt;h1 id="workbench-the-django-based-agency-software"&gt;&lt;a class="toclink" href="#workbench-the-django-based-agency-software"&gt;Workbench, the Django-based agency software&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;I get the impression that there&amp;rsquo;s a lot of interesting but unknown software in Django land. I don&amp;rsquo;t know if there&amp;rsquo;s any interest in some of the packages I have been working on; if not this blog post is for myself only.&lt;/p&gt;
&lt;h2 id="history-time"&gt;&lt;a class="toclink" href="#history-time"&gt;(Hi)story time&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;As people may know I work at &lt;a href="https://feinheit.ch/"&gt;Feinheit&lt;/a&gt;, an agency which specializes in digital communication services for SMEs, campaigns for referendums, and website and webapp development. At the time of writing we are a team of about 20-25 communication experts, graphic designers, programmers and project managers.&lt;/p&gt;
&lt;p&gt;We have many different clients and are working on many different projects at the same time and are billing by the hour&lt;sup id="fnref:bythehour"&gt;&lt;a class="footnote-ref" href="#fn:bythehour"&gt;1&lt;/a&gt;&lt;/sup&gt;. Last year my own work has been billed to more than 50 different customers. In the early days we used a shared file server with spreadsheet files to track our working hours. Luckily we didn&amp;rsquo;t often overwrite the edits others made but that was definitely something which happened from time to time.&lt;/p&gt;
&lt;p&gt;We knew of another agency who had the same problems and used a FileMaker-based software. Their solution had several problems, among them the fact that it became hard to evolve and that it got slower and slower as more and more data was entered into it over the years. They had the accounting know how and we had the software engineering know how so we wrote a webapp based on the Django framework. As always, it was much more work than the initial estimate, but if we as programmers didn&amp;rsquo;t underestimate the effort needed we wouldn&amp;rsquo;t have started many of the great projects we&amp;rsquo;re now getting much value and/or enjoyment from, hopefully both. The product of that work was &lt;a href="https://www.fineware.ch/"&gt;Metronom&lt;/a&gt;. The first release happened a little bit later than &lt;a href="https://www.getharvest.com/about"&gt;harvest&lt;/a&gt; but it already came with full time tracking including an annual working time calculator, absence management, offers, invoices including PDF generation etc, so it was quite a bit more versatile while still being easier to use than &amp;ldquo;real&amp;rdquo; business software solutions.&lt;/p&gt;
&lt;p&gt;I personally was of the opinion that the product was good enough to try selling it, but for a variety of reasons (which I don&amp;rsquo;t want to go into here) this never happened and &lt;a href="https://feinheit.ch/"&gt;we&lt;/a&gt; decided that we didn&amp;rsquo;t want to be involved anymore.&lt;/p&gt;
&lt;p&gt;However, this meant that we were dead-end street with a software that didn&amp;rsquo;t belong to us anymore, which wasn&amp;rsquo;t evolving to our changing requirements. I also didn&amp;rsquo;t enjoy working on it anymore. Over the years I have tried replacing it several times but that never came to pass until some time after the introduction of &lt;a href="https://www.holacracy.org/"&gt;Holacracy&lt;/a&gt; at our company. I noticed that I didn&amp;rsquo;t have to persuade everyone but that I, as the responsible person for this particular decision, could &amp;ldquo;just&amp;rdquo;&lt;sup id="fnref:just"&gt;&lt;a class="footnote-ref" href="#fn:just"&gt;2&lt;/a&gt;&lt;/sup&gt; move ahead with a broad interpretation of the purpose and accountabilities of one of my roles.&lt;/p&gt;
&lt;h2 id="workbench"&gt;&lt;a class="toclink" href="#workbench"&gt;&lt;a href="https://github.com/matthiask/workbench"&gt;Workbench&lt;/a&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;img alt="Screenshot" src="https://406.ch/assets/20240424-workbench.png" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/matthiask/workbench"&gt;Workbench&lt;/a&gt; is the product of a few long nights of hacking. The project was started as an experiment in 2015 and was used for sending invoices but that wasn&amp;rsquo;t really the intended purpose. After long periods of lying dormant I have brought the project to a good enough state and switched Feinheit away from Metronom in 2019.&lt;/p&gt;
&lt;p&gt;I have thought long and hard about switching to one of the off-the-shelf products and it could very well be that one of them would work well for us. Also, we wouldn&amp;rsquo;t have to pay (in form of working hours) for the maintenance and for enhancements ourselves. On the other hand, we can use a tool which is tailored to our needs. Is it worth the effort? That&amp;rsquo;s always hard to answer. The tool certainly works well for the few companies which are using it right now, so there&amp;rsquo;s no reason to agonize over that.&lt;/p&gt;
&lt;p&gt;At the time of writing, Workbench offers projects and services, offers and invoices incl. PDF generation, recurring invoices, an address book, a logbook for rendered services, annual working time reports, an acquisition funnel, a stupid project planning and resource management tool and various reports. It has not only replaced Metronom but also a selection of SaaS (for example Pipedrive and TeamGantt) we were using previously.&lt;/p&gt;
&lt;p&gt;The whole thing is open source because I don&amp;rsquo;t want to try making agency software into a business anymore, I only want to solve the problems &lt;em&gt;we&lt;/em&gt; have. That being said, if someone else finds it useful then that&amp;rsquo;s certainly alright as well.&lt;/p&gt;
&lt;p&gt;The license has been MIT for the first few years but I have switched to the GPL because I wanted to integrate the excellent &lt;a href="https://pypi.org/project/qrbill/"&gt;qrbill&lt;/a&gt; module which is also licensed under the GPL. As I wrote elsewhere, I have released almost everything under the GPL in my first few open source years but have switched to BSD/MIT later when starting to work mainly with Python and Django because I thought that this license is a better fit&lt;sup id="fnref:license"&gt;&lt;a class="footnote-ref" href="#fn:license"&gt;3&lt;/a&gt;&lt;/sup&gt; for the ecosystem. That being said, for a product such as this the GPL is certainly an excellent fit.&lt;/p&gt;
&lt;h2 id="final-words"&gt;&lt;a class="toclink" href="#final-words"&gt;Final words?&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;There are a few things I could write about to make this into a series. I&amp;rsquo;m putting a few ideas here, not as an announcement, just as a reminder for myself.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Better time tracking&lt;/li&gt;
&lt;li&gt;Patterns for creating recurring invoices&lt;/li&gt;
&lt;li&gt;Feature switches and configurability&lt;/li&gt;
&lt;li&gt;&lt;a href="https://406.ch/writing/workbench-coffee-time/"&gt;Coffee time&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="footnote"&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id="fn:bythehour"&gt;
&lt;p&gt;Rather, in six minute increments. It&amp;rsquo;s even worse.&amp;#160;&lt;a class="footnote-backref" href="#fnref:bythehour" title="Jump back to footnote 1 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id="fn:just"&gt;
&lt;p&gt;Of course it&amp;rsquo;s never that simple, because the responsibility is a lot. The important point is: It would have been a lot of work anyways, the big difference is that it was sufficient to get consent from people; no consensus required.&amp;#160;&lt;a class="footnote-backref" href="#fnref:just" title="Jump back to footnote 2 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id="fn:license"&gt;
&lt;p&gt;That&amp;rsquo;s not meant as a criticism in any way!&amp;#160;&lt;a class="footnote-backref" href="#fnref:license" title="Jump back to footnote 3 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</summary></entry><entry><title>Building forms with the Django admin</title><link href="https://406.ch/writing/building-forms-with-the-django-admin/" rel="alternate" /><id>https://406.ch/writing/building-forms-with-the-django-admin/</id><published>2024-04-12T12:00:00Z</published><updated>2024-04-12T12:00:00Z</updated><summary type="html">&lt;h1 id="building-forms-with-the-django-admin"&gt;&lt;a class="toclink" href="#building-forms-with-the-django-admin"&gt;Building forms with the Django admin&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;The title of this post was shamelessly copied from &lt;a href="https://mastodon.social/@webology/112235938469045649"&gt;Jeff Triplett&amp;rsquo;s post on
Mastodon&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id="why"&gt;&lt;a class="toclink" href="#why"&gt;Why?&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Many websites need a simple way of embedding forms, for example as a contact
form or for simple surveys to collect some data or inputs from visitors.
&lt;a href="https://docs.djangoproject.com/en/5.0/topics/forms/"&gt;Django&amp;rsquo;s forms library&lt;/a&gt;
makes building such forms straightforward but changing those forms requires
programming skills and programmer time. Both of them may not be readily
available. More importantly, sometimes it&amp;rsquo;s just nice to give more tools to web
publishers.&lt;/p&gt;
&lt;p&gt;The simple way to build something like this is to use a form builder such as
Google Forms, Typeform, Paperform or anything of the sort. Those options work
nicely. The downsides are that embedded forms using those services load slowly,
look differently, cost a lot or collect a lot of data on users, or all of those
options. Because of that there&amp;rsquo;s still a place for building such functionality
locally.&lt;/p&gt;
&lt;p&gt;If I wanted to use PHP and WordPress I could just use
&lt;a href="https://wpforms.com/"&gt;WPForms&lt;/a&gt; and call it a day. Since I do not actually want
that this blog post is a bit longer.&lt;/p&gt;
&lt;h2 id="the-early-days-form-designer"&gt;&lt;a class="toclink" href="#the-early-days-form-designer"&gt;The early days: form-designer&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;One of the first Django-based third party apps I published was the &lt;a href="https://github.com/feincms/form-designer"&gt;form-designer&lt;/a&gt;. The first version was uploaded to PyPI in 2012 but it had already been used in production for more than two years at that point in time. I had used &lt;a href="https://git-scm.com/book/en/v2/Git-Tools-Submodules"&gt;Git submodules&lt;/a&gt; for the deployment back then, before switching to &lt;a href="https://virtualenv.pypa.io/"&gt;Python virtualenvs&lt;/a&gt; some time later (and never looking back!)&lt;/p&gt;
&lt;p&gt;The form-designer is still maintained actively. Because of Django&amp;rsquo;s stability and because of the fact that the app doesn&amp;rsquo;t do all that much it doesn&amp;rsquo;t require much development at all.&lt;/p&gt;
&lt;p&gt;&lt;img alt="A screenshot of the admin interface" src="https://406.ch/assets/20240410-form-designer.png" /&gt;&lt;/p&gt;
&lt;p&gt;The form designer supports a selection of standard HTML5 input fields out of the box and also has an optional &lt;a href="https://github.com/django-recaptcha/django-recaptcha"&gt;django-recaptcha&lt;/a&gt; integration. All fields support some basic configuration such as setting a title, a help text, marking the field as required etc. Submissions can be sent to a configurable email address and can be saved in the database and later exported as an XLSX file. It&amp;rsquo;s also possible to define your own actions.&lt;/p&gt;
&lt;h2 id="more-flexibility-needed-feincms3-forms"&gt;&lt;a class="toclink" href="#more-flexibility-needed-feincms3-forms"&gt;More flexibility needed: feincms3-forms&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;A few years back I mentioned &lt;a href="https://406.ch/writing/weeknotes-2021-week-13-and-14/"&gt;feincms3-forms in a weeknotes entry&lt;/a&gt;. The reasons why form-designer wasn&amp;rsquo;t sufficient for a project back then are outlined in the blog post:&lt;/p&gt;
&lt;blockquote&gt;
&lt;h3 id="feincms3-forms-a-new-forms-builder-for-the-django-admin-interface"&gt;&lt;a class="toclink" href="#feincms3-forms-a-new-forms-builder-for-the-django-admin-interface"&gt;feincms3-forms  A new forms builder for the Django admin interface&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;For a current project &lt;a href="https://feinheit.ch/"&gt;we&lt;/a&gt; needed a forms builder with the following constraints:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Simple fields (text, email, checkboxes, dropdowns etc.)&lt;/li&gt;
&lt;li&gt;Custom validation and processing logic&lt;/li&gt;
&lt;li&gt;It should be possible to add other content, e.g. headings and explanations between form fields&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The &lt;a href="https://github.com/feincms/form_designer"&gt;form_designer&lt;/a&gt; fulfilled a few of these requirements but not all. It still works well but I wanted a forms builder based on &lt;a href="https://github.com/matthiask/django-content-editor"&gt;django-content-editor&lt;/a&gt; for a long time already. Also, I really like the feincms3 pattern where the third party app only provides abstract models. Yeah, it is much more work to start with but the flexibility and configurability is worth it  especially since it&amp;rsquo;s possible to write straightforward code to handle special cases[^2] instead of configuring even more settings.&lt;/p&gt;
&lt;p&gt;The humble beginnings are here in the &lt;a href="https://github.com/matthiask/feincms3-forms/"&gt;feincms3-forms&lt;/a&gt; repository. The &lt;a href="https://github.com/matthiask/feincms3-forms/tree/main/tests/testapp"&gt;test suite already shows how things work together&lt;/a&gt; but as of now no documentation exists and no release has been made yet. I hope it will be ready for a first beta release in the next few weeks &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Since then I have used feincms3-forms more often than form-designer, for building simple forms and also to build multi-step form wizards with custom fields, custom validation, configurable steps etc. The &lt;a href="https://github.com/feincms/feincms3-forms?tab=readme-ov-file#feincms3-forms"&gt;README&lt;/a&gt; now actually explains why the project exists and how it could be used.&lt;/p&gt;
&lt;p&gt;It still doesn&amp;rsquo;t come close to WPForms in terms of included functionality; a big feature which is missing is conditional logic because I haven&amp;rsquo;t yet had a use for it.&lt;/p&gt;
&lt;p&gt;&lt;img alt="The feincms3-forms admin interface" src="https://406.ch/assets/20240410-feincms3-forms.png" /&gt;&lt;/p&gt;
&lt;p&gt;The feincms3-forms forms support all types of content between form fields (basically everything &lt;a href="https://django-content-editor.readthedocs.io/"&gt;django-content-editor&lt;/a&gt; supports). Plugins for form fields are more flexible and can add as many input fields to the form as they want, you&amp;rsquo;re not restricted to single values or single input fields.&lt;/p&gt;
&lt;h2 id="packages"&gt;&lt;a class="toclink" href="#packages"&gt;Packages&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/feincms/form-designer"&gt;form-designer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/feincms/feincms3-forms"&gt;feincms3-forms&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</summary></entry><entry><title>Weeknotes (2024 week 14)</title><link href="https://406.ch/writing/weeknotes-2024-week-14/" rel="alternate" /><id>https://406.ch/writing/weeknotes-2024-week-14/</id><published>2024-04-06T12:00:00Z</published><updated>2024-04-06T12:00:00Z</updated><summary type="html">&lt;h1 id="weeknotes-2024-week-14"&gt;&lt;a class="toclink" href="#weeknotes-2024-week-14"&gt;Weeknotes (2024 week 14)&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;I&amp;rsquo;m having a bit of a slow week with the easter weekend and a wisdom tooth
extraction. I&amp;rsquo;m recovering quite quickly it seems and I&amp;rsquo;m glad about it.&lt;/p&gt;
&lt;p&gt;This weeknotes entry is short and quick. I&amp;rsquo;m trying to get back into the habit
of writing them after a mediocre start this year.&lt;/p&gt;
&lt;h2 id="20th-anniversary-celebration-of-young-greens-switzerland"&gt;&lt;a class="toclink" href="#20th-anniversary-celebration-of-young-greens-switzerland"&gt;20th Anniversary Celebration of Young Greens Switzerland&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I have attended the celebration of Young Greens Switzerland. I have been a
founding member and have been active for close to ten years. A lot of time has
passed since then. It has been great to reminisce about old times with friends
and, more importantly, to see how the torch is carried on.&lt;/p&gt;
&lt;h2 id="releases"&gt;&lt;a class="toclink" href="#releases"&gt;Releases&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/blacknoise/"&gt;blacknoise 0.0.5&lt;/a&gt;: blacknoise is an
  ASGI app for static file serving inspired by
  &lt;a href="https://whitenoise.readthedocs.io/en/latest/"&gt;whitenoise&lt;/a&gt;. It only supports
  a very limited subset of whitenoise&amp;rsquo;s functionality, but it supports async.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/html-sanitizer/"&gt;html-sanitizer 2.4.1&lt;/a&gt;: The lxml
  library moved the HTML cleaner into its own package,
  &lt;a href="https://pypi.org/project/lxml-html-clean/"&gt;lxml-html-clean&lt;/a&gt;; this release
  adds support for that. I didn&amp;rsquo;t know that the HTML cleaner is viewed as being
  problematic by the lxml maintainers. I&amp;rsquo;m having another look at
  &lt;a href="https://github.com/messense/nh3"&gt;nh3&lt;/a&gt; and will maybe switch html-sanitizer&amp;rsquo;s
  guts from lxml to nh3 in the future.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-tree-queries/"&gt;django-tree-queries 0.18&lt;/a&gt;:
  django-tree-queries now supports ordering siblings by multiple fields and
  even allows descending orderings.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pypi.org/project/django-cabinet/"&gt;django-cabinet 0.14.2&lt;/a&gt;: This
  release fixes the CKEditor 4 filebrowser popup when using Django 5 or better.&lt;/li&gt;
&lt;/ul&gt;</summary></entry><entry><title>The Django admin is a CMS</title><link href="https://406.ch/writing/the-django-admin-is-a-cms/" rel="alternate" /><id>https://406.ch/writing/the-django-admin-is-a-cms/</id><published>2024-03-27T12:00:00Z</published><updated>2024-03-27T12:00:00Z</updated><summary type="html">&lt;h1 id="the-django-admin-is-a-cms"&gt;&lt;a class="toclink" href="#the-django-admin-is-a-cms"&gt;The Django admin is a CMS&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;The post &lt;a href="https://www.coderedcorp.com/blog/why-is-the-django-admin-ugly/"&gt;Why is the Django Admin Ugly?&lt;/a&gt; and the &lt;a href="https://hachyderm.io/@paulox@fosstodon.org/111298440425647176"&gt;discussion on
Mastodon&lt;/a&gt; around it finally motivated me to write down my
thoughts regarding the recurring theme in Django land that the &lt;a href="https://docs.djangoproject.com/en/5.0/ref/contrib/admin/"&gt;Django
administration interface&lt;/a&gt; isn&amp;rsquo;t a CMS (Content Management
System).&lt;/p&gt;
&lt;p&gt;I think that this is misguided and needlessly limits the discourse around what
the admin&amp;rsquo;s current functionality is and the ideas what it could be and already
is.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://en.wikipedia.org/wiki/Web_content_management_system"&gt;A web content management system&lt;/a&gt; is about website authoring for users
who do not need to be web programming experts in their own rights. &lt;a href="https://en.wikipedia.org/wiki/Django_(web_framework)"&gt;Django was
created at the Lawrence Journal-World newspaper&lt;/a&gt;. The admin itself was
created to allow quickly spinning up new websites, where the admin interface
was used by content managers to fill in the content while programmers finalized
the rest of the website. So obviously the admin interface was a system used to
manage content&lt;sup id="fnref:words"&gt;&lt;a class="footnote-ref" href="#fn:words"&gt;1&lt;/a&gt;&lt;/sup&gt; from the beginning.&lt;/p&gt;
&lt;p&gt;Sure, the &lt;a href="https://docs.djangoproject.com/en/5.0/ref/contrib/admin/"&gt;Django admin site documentation&lt;/a&gt; states:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;One of the most powerful parts of Django is the automatic admin interface. It reads metadata from your models to provide a quick, model-centric interface where trusted users can manage content on your site. The admins recommended use is limited to an organizations internal management tool. &lt;strong&gt;Its not intended for building your entire front end around.&lt;/strong&gt; [emphasis added]&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;In other words, the Django documentation also points out that the admin is
powerful and that it allows trusted users to manage content&lt;sup id="fnref2:words"&gt;&lt;a class="footnote-ref" href="#fn:words"&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;Yes, it will be very painful if you try to do everything on top of the Django
admin site. The warnings against using the Django admin for more than it was
designed to are necessary and I totally support them. As soon as you&amp;rsquo;re getting
into workflows, into complex permission scenarios (sad noises) or similar
things the admin definitely isn&amp;rsquo;t for you. But, the admin nicely solves 90% of
the problems with 10% of the effort. And it&amp;rsquo;s very good at that.&lt;/p&gt;
&lt;p&gt;And sure, if you try building your own frontend on top of the Django admin
you&amp;rsquo;re in for a bumpy ride, but that much should be obvious.&lt;/p&gt;
&lt;p&gt;Many third party apps for Django actually target the Django admin interface
itself, and not one of the (excellent!) Django-based CMS such as
&lt;a href="https://wagtail.org/"&gt;Wagtail&lt;/a&gt;. This means that by building on the Django
admin instead of one of the CMS you&amp;rsquo;re &lt;a href="https://406.ch/writing/run-less-code-in-production-or-youll-end-up-paying-the-price-later/"&gt;running less code&lt;/a&gt;, by using
more libraries instead of frameworks (on top of frameworks) you&amp;rsquo;re &lt;a href="https://406.ch/writing/low-maintenance-software/"&gt;keeping
maintenance lower&lt;/a&gt;, and you&amp;rsquo;re a part of a larger
community&lt;sup id="fnref:community"&gt;&lt;a class="footnote-ref" href="#fn:community"&gt;2&lt;/a&gt;&lt;/sup&gt;, which brings the potential benefit of being able to
profit more from the general Django packages ecosystem.&lt;/p&gt;
&lt;p&gt;Since you&amp;rsquo;re depending on smaller pieces of additional software it will
generally be possible to upgrade to new Django versions quicker. This isn&amp;rsquo;t
true for all packages of course, and I&amp;rsquo;m a reluctant maintainer of some of
them. Anecdotes aren&amp;rsquo;t data, but I see that some larger CMS systems are
definitely having a hard time keeping up with Django&amp;rsquo;s release schedule.&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;m not trying to say that the Django admin is a better CMS than other
Django-based CMS, or any other CMS. I&amp;rsquo;m saying it&amp;rsquo;s a trade off and you should
be mindful of the downsides of choosing a larger system. And I&amp;rsquo;m saying that
the people who tell you that you shouldn&amp;rsquo;t be using the Django admin interface
are wrong in the first approximation.&lt;/p&gt;
&lt;p&gt;The fact that it&amp;rsquo;s so easy to spin up an additional site and with minimal
effort and still be able to work with clean database schemas and all the great
tools Django (and Python) offers is important for those of us who are working
on many different projects with limited financial resources, because the
website often is for example just a small part of a campaign.&lt;/p&gt;
&lt;div class="footnote"&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id="fn:words"&gt;
&lt;p&gt;Sorry-not-sorry for my choice of words.&amp;#160;&lt;a class="footnote-backref" href="#fnref:words" title="Jump back to footnote 1 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;a class="footnote-backref" href="#fnref2:words" title="Jump back to footnote 1 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id="fn:community"&gt;
&lt;p&gt;The assumption that the communities of these Django-based CMS projects are a subset of the Django community itself shouldn&amp;rsquo;t be too controversial.&amp;#160;&lt;a class="footnote-backref" href="#fnref:community" title="Jump back to footnote 2 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</summary></entry></feed>